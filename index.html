<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoTæ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-dark: #0a192f;
            --secondary-dark: #112240;
            --accent-blue: #64ffda;
            --accent-light-blue: #8ae9ff;
            --text-primary: #e6f1ff;
            --text-secondary: #8892b0;
            --success: #4CAF50;
            --warning: #ff9800;
            --danger: #f44336;
            --border-radius: 8px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--primary-dark);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* å°èˆªæ¬„æ¨£å¼ */
        nav {
            background-color: rgba(10, 25, 47, 0.95);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(100, 255, 218, 0.2);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-blue);
        }
        
        .logo i {
            font-size: 1.8rem;
        }
        
        .nav-links {
            display: flex;
            gap: 2rem;
        }
        
        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            transition: var(--transition);
            position: relative;
        }
        
        .nav-links a:hover, .nav-links a.active {
            color: var(--accent-blue);
            background-color: rgba(100, 255, 218, 0.1);
        }
        
        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 10%;
            width: 80%;
            height: 2px;
            background-color: var(--accent-blue);
        }
        
        /* è¡Œå‹•è£ç½®æ¼¢å ¡é¸å–® */
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* é é¢æ¨£å¼ */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .page.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* ä¸»é æ¨£å¼ */
        .hero {
            text-align: center;
            padding: 4rem 1rem;
            background: linear-gradient(135deg, rgba(17, 34, 64, 0.9) 0%, rgba(10, 25, 47, 0.9) 100%);
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            border: 1px solid rgba(100, 255, 218, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        }
        
        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-light-blue));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .hero p {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto 2rem;
        }
        
        .btn {
            display: inline-block;
            background-color: rgba(100, 255, 218, 0.1);
            color: var(--accent-blue);
            padding: 0.8rem 2rem;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 600;
            border: 1px solid var(--accent-blue);
            transition: var(--transition);
            cursor: pointer;
            margin: 0.5rem;
        }
        
        .btn:hover {
            background-color: rgba(100, 255, 218, 0.2);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(100, 255, 218, 0.1);
        }
        
        .btn-primary {
            background-color: var(--accent-blue);
            color: var(--primary-dark);
        }
        
        .btn-primary:hover {
            background-color: var(--accent-light-blue);
        }
        
        .btn-small {
            padding: 0.4rem 1rem;
            font-size: 0.9rem;
        }
        
        /* æ“ä½œæŒ‡å—æ¨£å¼ */
        .guide-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
            margin-bottom: 3rem;
        }
        
        .guide-step {
            background-color: var(--secondary-dark);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.1);
            transition: var(--transition);
            position: relative;
            counter-increment: step-counter;
        }
        
        .guide-step:hover {
            transform: translateY(-5px);
            border-color: var(--accent-blue);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .guide-step::before {
            content: counter(step-counter);
            position: absolute;
            top: -15px;
            left: -15px;
            width: 40px;
            height: 40px;
            background-color: var(--accent-blue);
            color: var(--primary-dark);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(100, 255, 218, 0.3);
        }
        
        .guide-step h3 {
            color: var(--accent-blue);
            margin-bottom: 1rem;
            padding-left: 0.5rem;
        }
        
        .guide-step p {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            padding-left: 0.5rem;
        }
        
        .step-tip {
            background-color: rgba(100, 255, 218, 0.1);
            padding: 0.8rem;
            border-radius: calc(var(--border-radius) - 2px);
            margin-top: 1rem;
            border-left: 3px solid var(--accent-blue);
        }
        
        .step-tip h4 {
            color: var(--accent-light-blue);
            margin-bottom: 0.3rem;
        }
        
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        
        .feature-card {
            background-color: var(--secondary-dark);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.1);
            transition: var(--transition);
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            border-color: var(--accent-blue);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .feature-card i {
            font-size: 2.5rem;
            color: var(--accent-blue);
            margin-bottom: 1rem;
        }
        
        /* ç©æ³•èªªæ˜æ¨£å¼ */
        .play-guide {
            background-color: var(--secondary-dark);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.2);
            margin: 2rem 0;
        }
        
        .play-guide h3 {
            color: var(--accent-blue);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .play-guide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        
        .play-item {
            background-color: rgba(10, 25, 47, 0.7);
            padding: 1.5rem;
            border-radius: calc(var(--border-radius) - 2px);
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .play-item h4 {
            color: var(--accent-light-blue);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .play-item p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* åŸå¸‚ç®¡ç†é é¢æ¨£å¼ */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .section-intro {
            background-color: rgba(17, 34, 64, 0.7);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--accent-blue);
            margin-bottom: 2rem;
        }
        
        .section-intro h3 {
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background-color: var(--secondary-dark);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--accent-blue);
        }
        
        .stat-card h3 {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        
        .stat-card .value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-blue);
        }
        
        .city-layout {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-top: 2rem;
        }
        
        @media (max-width: 992px) {
            .city-layout {
                grid-template-columns: 1fr;
            }
        }
        
        .city-map {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            min-height: 500px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .map-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 10px;
            height: 100%;
            margin-top: 1rem;
        }
        
        .grid-cell {
            background-color: rgba(10, 25, 47, 0.5);
            border-radius: 4px;
            border: 1px dashed rgba(100, 255, 218, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            transition: var(--transition);
            position: relative;
            min-height: 60px;
        }
        
        .grid-cell:hover {
            background-color: rgba(100, 255, 218, 0.05);
            cursor: pointer;
        }
        
        .grid-cell.occupied {
            border-style: solid;
            border-color: var(--accent-blue);
        }
        
        .grid-cell.hover {
            background-color: rgba(100, 255, 218, 0.1);
            border-color: var(--accent-blue);
        }
        
        .grid-cell.error {
            border-color: var(--danger);
            background-color: rgba(244, 67, 54, 0.1);
        }
        
        .sensor {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            color: white;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            cursor: move;
            position: relative;
            z-index: 10;
            transition: var(--transition);
        }
        
        .sensor:hover {
            transform: scale(1.1);
            z-index: 20;
        }
        
        .sensor.temperature {
            background: linear-gradient(135deg, #ff6b6b, #ee5a52);
        }
        
        .sensor.traffic {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
        }
        
        .sensor.energy {
            background: linear-gradient(135deg, #ffe66d, #f9c74f);
        }
        
        .sensor.security {
            background: linear-gradient(135deg, #9d4edd, #7b2cbf);
        }
        
        .sensor.water {
            background: linear-gradient(135deg, #4361ee, #3a0ca3);
        }
        
        .sensor.air {
            background: linear-gradient(135deg, #2a9d8f, #1d7876);
        }
        
        .sensor.waste {
            background: linear-gradient(135deg, #f77f00, #d62828);
        }
        
        .sensor-label {
            position: absolute;
            bottom: -20px;
            font-size: 0.7rem;
            color: var(--accent-light-blue);
            white-space: nowrap;
            z-index: 5;
            background-color: rgba(10, 25, 47, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .sensor-info {
            position: absolute;
            top: -40px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--secondary-dark);
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--accent-blue);
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 30;
            display: none;
        }
        
        .sensor:hover .sensor-info {
            display: block;
        }
        
        .controls-panel {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .sensor-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
            max-height: 400px;
            overflow-y: auto;
            padding-right: 5px;
        }
        
        .sensor-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .sensor-list::-webkit-scrollbar-track {
            background: rgba(10, 25, 47, 0.5);
            border-radius: 3px;
        }
        
        .sensor-list::-webkit-scrollbar-thumb {
            background: var(--accent-blue);
            border-radius: 3px;
        }
        
        .sensor-item {
            background-color: rgba(10, 25, 47, 0.7);
            padding: 1rem;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: move;
            transition: var(--transition);
            border: 1px solid transparent;
        }
        
        .sensor-item:hover {
            border-color: var(--accent-blue);
            transform: translateX(5px);
        }
        
        .sensor-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            color: white;
        }
        
        /* æ•¸æ“šåˆ†æé é¢æ¨£å¼ */
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .chart-box {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .chart {
            height: 300px;
            position: relative;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            padding: 1rem 0;
        }
        
        .bar {
            flex: 1;
            background: linear-gradient(to top, var(--accent-blue), var(--accent-light-blue));
            border-radius: 4px 4px 0 0;
            position: relative;
            transition: var(--transition);
            min-width: 40px;
        }
        
        .bar:hover {
            opacity: 0.8;
            transform: scaleY(1.05);
        }
        
        .bar-label {
            position: absolute;
            bottom: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .bar-value {
            position: absolute;
            top: -25px;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 0.9rem;
            color: var(--accent-blue);
            font-weight: 600;
        }
        
        /* æ•ˆèƒ½æŒ‡æ¨™æ¨£å¼ */
        .performance-metrics, .sensor-distribution, .prediction-chart {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            margin-top: 1rem;
        }
        
        .metric, .distribution-item, .prediction-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .metric-label, .distribution-label, .prediction-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        
        .metric-value, .distribution-value, .prediction-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--accent-blue);
        }
        
        .metric-bar, .distribution-bar, .prediction-bar {
            height: 8px;
            background-color: rgba(10, 25, 47, 0.7);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .metric-fill, .prediction-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-light-blue));
            border-radius: 4px;
        }
        
        .distribution-fill.temperature {
            background: linear-gradient(90deg, #ff6b6b, #ee5a52);
        }
        
        .distribution-fill.traffic {
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
        }
        
        .distribution-fill.energy {
            background: linear-gradient(90deg, #ffe66d, #f9c74f);
        }
        
        .distribution-fill.security {
            background: linear-gradient(90deg, #9d4edd, #7b2cbf);
        }
        
        /* ç³»çµ±å„ªåŒ–é é¢æ¨£å¼ */
        .optimization-panels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        
        .panel {
            background-color: var(--secondary-dark);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .budget-meter {
            height: 20px;
            background-color: rgba(10, 25, 47, 0.7);
            border-radius: 10px;
            margin: 1.5rem 0;
            overflow: hidden;
        }
        
        .budget-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-light-blue));
            border-radius: 10px;
            width: 65%;
            transition: width 1s ease;
        }
        
        .budget-details, .energy-status, .optimization-tips, .prediction-details {
            margin-top: 1.5rem;
        }
        
        .budget-item, .energy-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .budget-item.total, .energy-item:last-child {
            border-bottom: none;
            font-weight: 600;
            color: var(--accent-blue);
        }
        
        .alert-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .alert {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background-color: rgba(10, 25, 47, 0.7);
            border-radius: var(--border-radius);
            border-left: 4px solid;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .alert:hover {
            transform: translateX(5px);
            background-color: rgba(10, 25, 47, 0.9);
        }
        
        .alert.warning {
            border-left-color: var(--warning);
        }
        
        .alert.danger {
            border-left-color: var(--danger);
        }
        
        .alert.info {
            border-left-color: var(--accent-blue);
        }
        
        /* é€šçŸ¥æ¨£å¼ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            color: white;
            border-radius: var(--border-radius);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 400px;
        }
        
        .notification.success {
            background-color: rgba(76, 175, 80, 0.95);
            border-left: 4px solid #2e7d32;
        }
        
        .notification.warning {
            background-color: rgba(255, 152, 0, 0.95);
            border-left: 4px solid #ef6c00;
        }
        
        .notification.danger {
            background-color: rgba(244, 67, 54, 0.95);
            border-left: 4px solid #c62828;
        }
        
        .notification.info {
            background-color: rgba(100, 255, 218, 0.95);
            color: var(--primary-dark);
            border-left: 4px solid var(--accent-blue);
        }
        
        .notification-close {
            background: none;
            border: none;
            color: inherit;
            font-size: 1.2rem;
            cursor: pointer;
            margin-left: 1rem;
            opacity: 0.8;
        }
        
        .notification-close:hover {
            opacity: 1;
        }
        
        /* é€²åº¦æ¢æ¨£å¼ */
        .progress-container {
            margin: 1.5rem 0;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .progress-bar {
            height: 10px;
            background-color: rgba(10, 25, 47, 0.7);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 0.5s ease;
        }
        
        .progress-fill.good {
            background: linear-gradient(90deg, var(--success), #81c784);
        }
        
        .progress-fill.warning {
            background: linear-gradient(90deg, var(--warning), #ffb74d);
        }
        
        .progress-fill.danger {
            background: linear-gradient(90deg, var(--danger), #e57373);
        }
        
        /* é è…³æ¨£å¼ */
        footer {
            text-align: center;
            padding: 2rem;
            margin-top: 3rem;
            color: var(--text-secondary);
            border-top: 1px solid rgba(100, 255, 218, 0.1);
            font-size: 0.9rem;
        }
        
        .copyright {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(100, 255, 218, 0.1);
            color: var(--accent-light-blue);
        }
        
        /* æ¨¡æ…‹æ¡†æ¨£å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: var(--secondary-dark);
            padding: 2rem;
            border-radius: var(--border-radius);
            max-width: 500px;
            width: 90%;
            border: 1px solid var(--accent-blue);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--accent-blue);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 0.8rem;
            background-color: rgba(10, 25, 47, 0.7);
            border: 1px solid rgba(100, 255, 218, 0.2);
            border-radius: var(--border-radius);
            color: var(--text-primary);
            font-size: 1rem;
        }
        
        /* éŠæˆ²æ¨¡å¼æ¨£å¼ */
        .game-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .mode-card {
            background-color: var(--secondary-dark);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.1);
            transition: var(--transition);
            cursor: pointer;
        }
        
        .mode-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-blue);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .mode-card.active {
            border-color: var(--accent-blue);
            background-color: rgba(100, 255, 218, 0.05);
        }
        
        .mode-card h4 {
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .mode-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* éŸ¿æ‡‰å¼èª¿æ•´ */
        @media (max-width: 768px) {
            .nav-links {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background-color: var(--primary-dark);
                flex-direction: column;
                padding: 1rem;
                border-top: 1px solid rgba(100, 255, 218, 0.2);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            }
            
            .nav-links.active {
                display: flex;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .charts-container, .optimization-panels {
                grid-template-columns: 1fr;
            }
            
            .city-map {
                min-height: 400px;
            }
            
            .map-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: repeat(8, 1fr);
            }
            
            .notification {
                max-width: 90%;
                left: 5%;
                right: 5%;
            }
            
            .guide-container {
                grid-template-columns: 1fr;
            }
        }
        
        .text-secondary {
            color: var(--text-secondary);
        }
        
        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--secondary-dark);
            color: var(--text-primary);
            text-align: center;
            border-radius: var(--border-radius);
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            border: 1px solid var(--accent-blue);
            font-size: 0.9rem;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* è¼‰å…¥å‹•ç•« */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(100, 255, 218, 0.3);
            border-radius: 50%;
            border-top-color: var(--accent-blue);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* æŒ‘æˆ°ä»»å‹™æ¨£å¼ */
        .challenge-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .challenge-card {
            background-color: var(--secondary-dark);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.1);
        }
        
        .challenge-card.completed {
            border-color: var(--success);
            background-color: rgba(76, 175, 80, 0.05);
        }
        
        .challenge-card h4 {
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .challenge-card .reward {
            background-color: rgba(255, 193, 7, 0.2);
            color: #ffc107;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
        }
        
        .challenge-progress {
            margin-top: 1rem;
        }
        
        .challenge-progress .progress-label {
            font-size: 0.8rem;
        }
        
        /* å·¥å…·é¢æ¿æ¨£å¼ */
        .tool-panel {
            background-color: var(--secondary-dark);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(100, 255, 218, 0.1);
            margin-top: 2rem;
        }
        
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .tool-item {
            background-color: rgba(10, 25, 47, 0.7);
            padding: 1rem;
            border-radius: calc(var(--border-radius) - 2px);
            border: 1px solid rgba(100, 255, 218, 0.1);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .tool-item:hover {
            border-color: var(--accent-blue);
            transform: translateY(-3px);
        }
        
        .tool-item i {
            color: var(--accent-blue);
            font-size: 1.2rem;
        }
        
        .tool-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .tool-item.disabled:hover {
            transform: none;
            border-color: rgba(100, 255, 218, 0.1);
        }
    </style>
</head>
<body>
    <!-- å°èˆªæ¬„ -->
    <nav>
        <div class="logo">
            <i class="fas fa-city"></i>
            <span>IoTæ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨</span>
        </div>
        <button class="mobile-menu-btn" id="mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>
        <div class="nav-links" id="nav-links">
            <a href="#" class="nav-link active" data-page="home">é¦–é </a>
            <a href="#" class="nav-link" data-page="city">åŸå¸‚ç®¡ç†</a>
            <a href="#" class="nav-link" data-page="data">æ•¸æ“šåˆ†æ</a>
            <a href="#" class="nav-link" data-page="optimization">ç³»çµ±å„ªåŒ–</a>
        </div>
    </nav>
    
    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- é¦–é  -->
        <div id="home-page" class="page active">
            <div class="hero">
                <h1>ç‰©è¯ç¶²æ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨</h1>
                <p>é€™æ˜¯ä¸€å€‹äº’å‹•å¼æ¨¡æ“¬å¹³å°ï¼Œè®“æ‚¨é«”é©—å¦‚ä½•éƒ¨ç½²å’Œç®¡ç†ç‰©è¯ç¶²æ„Ÿæ¸¬å™¨ï¼Œä»¥å„ªåŒ–ç¾ä»£åŸå¸‚çš„é‹ä½œã€‚éƒ¨ç½²æ„Ÿæ¸¬å™¨ã€ç›£æ§å¯¦æ™‚æ•¸æ“šã€ç®¡ç†é ç®—ï¼Œä¸¦é˜²æ­¢ç³»çµ±æ•…éšœã€‚</p>
                <div>
                    <button class="btn btn-primary" id="start-simulation">é–‹å§‹æ¨¡æ“¬</button>
                    <button class="btn" id="guide-btn">å¹³å°æ“ä½œæŒ‡å—</button>
                </div>
            </div>
            
            <div class="guide-container" id="guide-container" style="display: none;">
                <div class="guide-step">
                    <h3>æ­¥é©Ÿä¸€ï¼šäº†è§£åŸºæœ¬æ¦‚å¿µ</h3>
                    <p>æ™ºæ…§åŸå¸‚é€šéç‰©è¯ç¶²æ„Ÿæ¸¬å™¨æ”¶é›†æ•¸æ“šï¼Œå„ªåŒ–åŸå¸‚é‹ä½œã€‚æœ¬æ¨¡æ“¬å™¨è®“æ‚¨é«”é©—å¾é›¶é–‹å§‹å»ºè¨­æ™ºæ…§åŸå¸‚çš„éç¨‹ã€‚</p>
                    <div class="step-tip">
                        <h4>ğŸ“š å­¸ç¿’è¦é»</h4>
                        <p>â€¢ ç‰©è¯ç¶²æ„Ÿæ¸¬å™¨é¡å‹èˆ‡åŠŸèƒ½</p>
                        <p>â€¢ åŸå¸‚å€åŸŸåŠƒåˆ†èˆ‡æ„Ÿæ¸¬å™¨ä½ˆå±€</p>
                        <p>â€¢ æ•¸æ“šæ”¶é›†èˆ‡åˆ†æçš„é‡è¦æ€§</p>
                    </div>
                </div>
                
                <div class="guide-step">
                    <h3>æ­¥é©ŸäºŒï¼šéƒ¨ç½²æ„Ÿæ¸¬å™¨</h3>
                    <p>åœ¨ã€ŒåŸå¸‚ç®¡ç†ã€é é¢ï¼Œæ‹–æ”¾æ„Ÿæ¸¬å™¨åˆ°åŸå¸‚åœ°åœ–ä¸Šã€‚ä¸åŒå€åŸŸéœ€è¦ä¸åŒé¡å‹çš„æ„Ÿæ¸¬å™¨ä¾†æ”¶é›†æ•¸æ“šã€‚</p>
                    <div class="step-tip">
                        <h4>ğŸ¯ éƒ¨ç½²æŠ€å·§</h4>
                        <p>â€¢ ä½å®…å€ï¼šéƒ¨ç½²æº«åº¦ã€èƒ½æºæ„Ÿæ¸¬å™¨</p>
                        <p>â€¢ å•†æ¥­å€ï¼šéƒ¨ç½²äº¤é€šã€å®‰å…¨æ„Ÿæ¸¬å™¨</p>
                        <p>â€¢ å·¥æ¥­å€ï¼šéƒ¨ç½²èƒ½æºã€ç©ºæ°£å“è³ªæ„Ÿæ¸¬å™¨</p>
                    </div>
                </div>
                
                <div class="guide-step">
                    <h3>æ­¥é©Ÿä¸‰ï¼šç›£æ§æ•¸æ“š</h3>
                    <p>åœ¨ã€Œæ•¸æ“šåˆ†æã€é é¢ï¼ŒæŸ¥çœ‹å„ç¨®æ„Ÿæ¸¬å™¨æ”¶é›†çš„æ•¸æ“šã€‚åœ–è¡¨å’ŒæŒ‡æ¨™å¹«åŠ©æ‚¨äº†è§£åŸå¸‚é‹ä½œç‹€æ…‹ã€‚</p>
                    <div class="step-tip">
                        <h4>ğŸ“Š ç›£æ§é‡é»</h4>
                        <p>â€¢ èƒ½æºæ¶ˆè€—è¶¨å‹¢åœ–</p>
                        <p>â€¢ ç³»çµ±æ•ˆèƒ½æŒ‡æ¨™</p>
                        <p>â€¢ æ„Ÿæ¸¬å™¨åˆ†ä½ˆçµ±è¨ˆ</p>
                    </div>
                </div>
                
                <div class="guide-step">
                    <h3>æ­¥é©Ÿå››ï¼šç³»çµ±å„ªåŒ–</h3>
                    <p>åœ¨ã€Œç³»çµ±å„ªåŒ–ã€é é¢ï¼Œæ ¹æ“šæ•¸æ“šåˆ†æçµæœé€²è¡Œç³»çµ±èª¿æ•´ã€‚å¹³è¡¡é ç®—ã€èƒ½æºæ¶ˆè€—èˆ‡ç³»çµ±æ•ˆèƒ½ã€‚</p>
                    <div class="step-tip">
                        <h4>âš™ï¸ å„ªåŒ–ç­–ç•¥</h4>
                        <p>â€¢ èª¿æ•´æ„Ÿæ¸¬å™¨å–æ¨£ç‡</p>
                        <p>â€¢ é‡æ–°åˆ†é…é ç®—</p>
                        <p>â€¢ è™•ç†ç³»çµ±è­¦å ±</p>
                    </div>
                </div>
                
                <div class="guide-step">
                    <h3>æ­¥é©Ÿäº”ï¼šæŒ‘æˆ°èˆ‡é€²éšç©æ³•</h3>
                    <p>å®ŒæˆåŸºæœ¬æ“ä½œå¾Œï¼Œå˜—è©¦å„ç¨®æŒ‘æˆ°ä»»å‹™å’Œé€²éšç©æ³•ï¼Œæå‡æ‚¨çš„åŸå¸‚ç®¡ç†æ°´å¹³ã€‚</p>
                    <div class="step-tip">
                        <h4>ğŸš€ é€²éšæŒ‘æˆ°</h4>
                        <p>â€¢ é ç®—é™åˆ¶æ¨¡å¼</p>
                        <p>â€¢ èƒ½æºæ•ˆç‡æŒ‘æˆ°</p>
                        <p>â€¢ ç½é›£æ‡‰å°æ¨¡æ“¬</p>
                    </div>
                </div>
                
                <div class="guide-step">
                    <h3>æ­¥é©Ÿå…­ï¼šå·¥å…·èˆ‡è³‡æº</h3>
                    <p>åˆ©ç”¨å„ç¨®å·¥å…·å’Œè³‡æºä¾†æå‡ç®¡ç†æ•ˆç‡ã€‚æ¯å€‹é é¢éƒ½æœ‰å°ˆç”¨å·¥å…·å¹«åŠ©æ‚¨æ›´å¥½åœ°ç®¡ç†åŸå¸‚ã€‚</p>
                    <div class="step-tip">
                        <h4>ğŸ› ï¸ å¯ç”¨å·¥å…·</h4>
                        <p>â€¢ æ„Ÿæ¸¬å™¨é…ç½®å·¥å…·</p>
                        <p>â€¢ æ•¸æ“šå°å‡ºåŠŸèƒ½</p>
                        <p>â€¢ æ•ˆèƒ½é æ¸¬å·¥å…·</p>
                    </div>
                </div>
            </div>
            
            <div class="features">
                <div class="feature-card">
                    <i class="fas fa-microchip"></i>
                    <h3>æ„Ÿæ¸¬å™¨éƒ¨ç½²</h3>
                    <p>ä½¿ç”¨æ‹–æ”¾æ–¹å¼åœ¨è™›æ“¬åŸå¸‚ä¸­éƒ¨ç½²å„ç¨®æ„Ÿæ¸¬å™¨ï¼ŒåŒ…æ‹¬æº«åº¦ã€äº¤é€šã€èƒ½æºã€å®‰å…¨ã€æ°´è³ªã€ç©ºæ°£å“è³ªå’Œå»¢ç‰©ç®¡ç†ç­‰æ„Ÿæ¸¬å™¨ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-chart-line"></i>
                    <h3>å¯¦æ™‚æ•¸æ“šç›£æ§</h3>
                    <p>é€šéäº’å‹•å¼åœ–è¡¨ç›£æ§ä¾†è‡ªæ‰€æœ‰æ„Ÿæ¸¬å™¨çš„å¯¦æ™‚æ•¸æ“šï¼Œåˆ†æåŸå¸‚é‹ä½œæ•ˆèƒ½ã€‚æ•¸æ“šæœƒæ ¹æ“šæ„Ÿæ¸¬å™¨ç‹€æ…‹å‹•æ…‹æ›´æ–°ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-cogs"></i>
                    <h3>ç³»çµ±å„ªåŒ–</h3>
                    <p>å¹³è¡¡é ç®—ã€èƒ½æºæ¶ˆè€—èˆ‡ç³»çµ±æ•ˆç‡ï¼Œé˜²æ­¢è¶…è¼‰ä¸¦æ‡‰å°çªç™¼äº‹ä»¶æŒ‘æˆ°ã€‚æä¾›å…·é«”çš„å„ªåŒ–å»ºè­°å’Œæ•ˆèƒ½é æ¸¬ã€‚</p>
                </div>
            </div>
            
            <div class="play-guide">
                <h3><i class="fas fa-gamepad"></i> å¹³å°ç©æ³•ä»‹ç´¹</h3>
                <div class="play-guide-grid">
                    <div class="play-item">
                        <h4><i class="fas fa-bullseye"></i> æŒ‘æˆ°æ¨¡å¼</h4>
                        <p>åœ¨æœ‰é™é ç®—å’Œæ™‚é–“å…§å®Œæˆç‰¹å®šç›®æ¨™ï¼Œå¦‚é™ä½èƒ½æºæ¶ˆè€—20%æˆ–æå‡ç³»çµ±æ•ˆèƒ½è‡³90%ä»¥ä¸Šã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fasfa-trophy"></i> æˆå°±ç³»çµ±</h4>
                        <p>å®Œæˆç‰¹å®šä»»å‹™ç²å¾—æˆå°±ï¼Œå¦‚ã€Œç¯€èƒ½å¤§å¸«ã€ã€ã€Œé«˜æ•ˆèƒ½åŸå¸‚ã€ç­‰ç¨±è™Ÿã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-users"></i> å¤šäººå”ä½œ</h4>
                        <p>æ¨¡æ“¬åœ˜éšŠåˆä½œç®¡ç†åŸå¸‚ï¼Œä¸åŒè§’è‰²è² è²¬ä¸åŒå€åŸŸï¼Œéœ€è¦å”èª¿åˆä½œé”æˆç›®æ¨™ã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-exclamation-triangle"></i> ç½é›£æ¨¡æ“¬</h4>
                        <p>æ¨¡æ“¬è‡ªç„¶ç½å®³æˆ–ç³»çµ±æ•…éšœï¼Œè€ƒé©—æ‚¨çš„æ‡‰æ€¥è™•ç†èƒ½åŠ›å’Œç³»çµ±éŸŒæ€§ã€‚</p>
                    </div>
                </div>
            </div>
            
            <div class="game-modes">
                <div class="mode-card" data-mode="easy">
                    <h4><i class="fas fa-seedling"></i> åˆå­¸è€…æ¨¡å¼</h4>
                    <p>é ç®—å……è¶³ï¼Œæ„Ÿæ¸¬å™¨ç¶­è­·æˆæœ¬ä½ï¼Œé©åˆå­¸ç¿’åŸºæœ¬æ“ä½œå’Œæ¦‚å¿µã€‚</p>
                </div>
                <div class="mode-card active" data-mode="normal">
                    <h4><i class="fas fa-balance-scale"></i> æ¨™æº–æ¨¡å¼</h4>
                    <p>å¹³è¡¡çš„é ç®—å’ŒæŒ‘æˆ°ï¼Œé©åˆå·²ç¶“æŒæ¡åŸºæœ¬æ“ä½œçš„ç©å®¶ã€‚</p>
                </div>
                <div class="mode-card" data-mode="hard">
                    <h4><i class="fas fa-skull-crossbones"></i> å°ˆå®¶æ¨¡å¼</h4>
                    <p>é ç®—ç·Šå¼µï¼Œç³»çµ±å®¹æ˜“æ•…éšœï¼Œé©åˆå°‹æ±‚æŒ‘æˆ°çš„é€²éšç©å®¶ã€‚</p>
                </div>
                <div class="mode-card" data-mode="creative">
                    <h4><i class="fas fa-palette"></i> å‰µæ„æ¨¡å¼</h4>
                    <p>ç„¡é ç®—é™åˆ¶ï¼Œè‡ªç”±è¨­è¨ˆç†æƒ³æ™ºæ…§åŸå¸‚ï¼Œå°ˆæ³¨æ–¼è¦åŠƒèˆ‡è¨­è¨ˆã€‚</p>
                </div>
            </div>
            
            <div class="copyright">
                <p>ç‰ˆæ¬Šè²æ˜ Â© 2026 Create By ã€ Sam.T ã€‘</p>
                <p>Copyright Â© 2026 Sam.T. All rights reserved.</p>
                <p>ç‰ˆæ¬Šæ‰€æœ‰Â© 2026 Sam.T</p>
            </div>
        </div>
        
        <!-- åŸå¸‚ç®¡ç†é é¢ -->
        <div id="city-page" class="page">
            <div class="dashboard-header">
                <h2>æ™ºæ…§åŸå¸‚ç®¡ç†é¢æ¿</h2>
                <div>
                    <button class="btn" id="reset-city">é‡ç½®åŸå¸‚</button>
                    <button class="btn btn-primary" id="add-sensor-btn">æ–°å¢æ„Ÿæ¸¬å™¨</button>
                </div>
            </div>
            
            <div class="section-intro">
                <h3><i class="fas fa-map-marked-alt"></i> åŸå¸‚ç®¡ç†æŒ‡å—</h3>
                <p>åœ¨æ­¤é é¢éƒ¨ç½²å’Œç®¡ç†æ‚¨çš„æ„Ÿæ¸¬å™¨ç¶²çµ¡ã€‚æ‹–æ”¾æ„Ÿæ¸¬å™¨åˆ°åœ°åœ–ä¸Šï¼Œé»æ“Šæ„Ÿæ¸¬å™¨æŸ¥çœ‹è©³æƒ…ï¼Œæ‹–å‹•å¯ç§»å‹•ä½ç½®ã€‚ä¸åŒå€åŸŸéœ€è¦ä¸åŒé¡å‹çš„æ„Ÿæ¸¬å™¨ä»¥ç²å¾—æœ€ä½³æ•ˆæœã€‚</p>
            </div>
            
            <div class="play-guide">
                <h3><i class="fas fa-lightbulb"></i> åŸå¸‚ç®¡ç†ç©æ³•</h3>
                <div class="play-guide-grid">
                    <div class="play-item">
                        <h4><i class="fas fa-chess-board"></i> å€åŸŸè¦åŠƒ</h4>
                        <p>å°‡åŸå¸‚åŠƒåˆ†ç‚ºä½å®…ã€å•†æ¥­ã€å·¥æ¥­ç­‰å€åŸŸï¼Œæ¯å€‹å€åŸŸéƒ¨ç½²ç›¸æ‡‰çš„æ„Ÿæ¸¬å™¨ã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-project-diagram"></i> ç¶²çµ¡å„ªåŒ–</h4>
                        <p>ç¢ºä¿æ„Ÿæ¸¬å™¨è¦†è“‹å‡å‹»ï¼Œé¿å…é‡è¤‡éƒ¨ç½²ï¼Œå„ªåŒ–æ•¸æ“šæ”¶é›†æ•ˆç‡ã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-money-bill-wave"></i> æˆæœ¬æ§åˆ¶</h4>
                        <p>åœ¨é ç®—å…§é¸æ“‡æ€§åƒ¹æ¯”æœ€é«˜çš„æ„Ÿæ¸¬å™¨çµ„åˆï¼Œå¹³è¡¡æˆæœ¬èˆ‡æ•ˆèƒ½ã€‚</p>
                    </div>
                </div>
            </div>
            
            <div class="stats-cards">
                <div class="stat-card">
                    <h3>å·²éƒ¨ç½²æ„Ÿæ¸¬å™¨</h3>
                    <div class="value" id="sensor-count">8</div>
                </div>
                <div class="stat-card">
                    <h3>ç³»çµ±æ•ˆèƒ½</h3>
                    <div class="value" id="system-efficiency">87%</div>
                </div>
                <div class="stat-card">
                    <h3>é ç®—ä½¿ç”¨</h3>
                    <div class="value" id="budget-usage">65%</div>
                </div>
                <div class="stat-card">
                    <h3>èƒ½æºæ¶ˆè€—</h3>
                    <div class="value" id="energy-consumption">2.4kW</div>
                </div>
            </div>
            
            <div class="city-layout">
                <div class="city-map">
                    <h3>åŸå¸‚åœ°åœ– <span class="tooltip">â„¹ï¸
                        <span class="tooltiptext">æ‹–æ”¾æ„Ÿæ¸¬å™¨åˆ°åœ°åœ–ä¸Šï¼Œé»æ“Šæ„Ÿæ¸¬å™¨æŸ¥çœ‹è©³æƒ…ï¼Œæ‹–å‹•å¯ç§»å‹•ä½ç½®</span>
                    </span></h3>
                    <p class="text-secondary">æ‹–æ”¾æ„Ÿæ¸¬å™¨åˆ°åœ°åœ–ä¸Šçš„ä»»ä½•ä½ç½®ï¼ˆé»æ“Šå·²éƒ¨ç½²æ„Ÿæ¸¬å™¨å¯æŸ¥çœ‹è©³æƒ…ï¼Œæ‹–å‹•å¯ç§»å‹•ä½ç½®ï¼‰</p>
                    
                    <div class="map-grid" id="city-grid">
                        <!-- ç¶²æ ¼å–®å…ƒå°‡ç”±JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="controls-panel">
                    <h3>å¯ç”¨æ„Ÿæ¸¬å™¨</h3>
                    <p class="text-secondary">æ‹–å‹•æ„Ÿæ¸¬å™¨åˆ°åŸå¸‚åœ°åœ–ä¸Š</p>
                    
                    <div class="sensor-list" id="sensor-list">
                        <div class="sensor-item" data-type="temperature" data-cost="120" data-energy="0.3">
                            <div class="sensor-icon temperature">
                                <i class="fas fa-thermometer-half"></i>
                            </div>
                            <div>
                                <h4>æº«åº¦æ„Ÿæ¸¬å™¨</h4>
                                <p>æˆæœ¬: $120 | èƒ½è€—: 0.3kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="traffic" data-cost="200" data-energy="0.5">
                            <div class="sensor-icon traffic">
                                <i class="fas fa-traffic-light"></i>
                            </div>
                            <div>
                                <h4>äº¤é€šæ„Ÿæ¸¬å™¨</h4>
                                <p>æˆæœ¬: $200 | èƒ½è€—: 0.5kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="energy" data-cost="180" data-energy="0.4">
                            <div class="sensor-icon energy">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div>
                                <h4>èƒ½æºæ„Ÿæ¸¬å™¨</h4>
                                <p>æˆæœ¬: $180 | èƒ½è€—: 0.4kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="security" data-cost="250" data-energy="0.6">
                            <div class="sensor-icon security">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div>
                                <h4>å®‰å…¨ç›£æ§</h4>
                                <p>æˆæœ¬: $250 | èƒ½è€—: 0.6kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="water" data-cost="220" data-energy="0.4">
                            <div class="sensor-icon water">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div>
                                <h4>æ°´è³ªç›£æ¸¬</h4>
                                <p>æˆæœ¬: $220 | èƒ½è€—: 0.4kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="air" data-cost="190" data-energy="0.35">
                            <div class="sensor-icon air">
                                <i class="fas fa-wind"></i>
                            </div>
                            <div>
                                <h4>ç©ºæ°£å“è³ª</h4>
                                <p>æˆæœ¬: $190 | èƒ½è€—: 0.35kW</p>
                            </div>
                        </div>
                        <div class="sensor-item" data-type="waste" data-cost="170" data-energy="0.3">
                            <div class="sensor-icon waste">
                                <i class="fas fa-trash-alt"></i>
                            </div>
                            <div>
                                <h4>å»¢ç‰©ç®¡ç†</h4>
                                <p>æˆæœ¬: $170 | èƒ½è€—: 0.3kW</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="budget-info" style="margin-top: 2rem;">
                        <h4>é ç®—ç‹€æ…‹</h4>
                        <div class="budget-meter">
                            <div class="budget-fill" id="budget-fill"></div>
                        </div>
                        <p>å·²ä½¿ç”¨: <span id="budget-used">$1,950</span> / ç¸½é ç®—: $<span id="total-budget">3,000</span></p>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>ç³»çµ±è² è¼‰</span>
                            <span id="system-load">65%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="system-load-bar" style="width: 65%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="challenge-container">
                <div class="challenge-card" id="challenge1">
                    <h4>åŸå¸‚è¦åŠƒå¸« <span class="reward">çå‹µ: $500</span></h4>
                    <p>åœ¨æ¯å€‹å€åŸŸè‡³å°‘éƒ¨ç½²1å€‹æ„Ÿæ¸¬å™¨ï¼ˆä½å®…ã€å•†æ¥­ã€å·¥æ¥­ã€å…¬åœ’ã€äº¤é€šï¼‰</p>
                    <div class="challenge-progress">
                        <div class="progress-label">
                            <span>é€²åº¦</span>
                            <span id="challenge1-progress">2/5</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 40%"></div>
                        </div>
                    </div>
                </div>
                <div class="challenge-card" id="challenge2">
                    <h4>ç¯€èƒ½å°ˆå®¶ <span class="reward">çå‹µ: $300</span></h4>
                    <p>å°‡ç¸½èƒ½æºæ¶ˆè€—æ§åˆ¶åœ¨2.0kWä»¥ä¸‹</p>
                    <div class="challenge-progress">
                        <div class="progress-label">
                            <span>é€²åº¦</span>
                            <span id="challenge2-progress">2.4/2.0kW</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill warning" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
                <div class="challenge-card completed" id="challenge3">
                    <h4>æ„Ÿæ¸¬å™¨å¤§å¸« <span class="reward">å·²å®Œæˆ âœ“</span></h4>
                    <p>éƒ¨ç½²è‡³å°‘5å€‹ä¸åŒé¡å‹çš„æ„Ÿæ¸¬å™¨</p>
                    <div class="challenge-progress">
                        <div class="progress-label">
                            <span>é€²åº¦</span>
                            <span>5/5</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill good" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tool-panel">
                <h3><i class="fas fa-tools"></i> åŸå¸‚ç®¡ç†å·¥å…·</h3>
                <div class="tool-grid">
                    <div class="tool-item" id="auto-deploy">
                        <i class="fas fa-robot"></i>
                        <div>
                            <h4>æ™ºèƒ½éƒ¨ç½²</h4>
                            <p>AIæ¨è–¦æœ€ä½³æ„Ÿæ¸¬å™¨ä½ç½®</p>
                        </div>
                    </div>
                    <div class="tool-item" id="sensor-config">
                        <i class="fas fa-sliders-h"></i>
                        <div>
                            <h4>æ‰¹é‡é…ç½®</h4>
                            <p>ä¸€æ¬¡èª¿æ•´å¤šå€‹æ„Ÿæ¸¬å™¨è¨­å®š</p>
                        </div>
                    </div>
                    <div class="tool-item" id="heatmap">
                        <i class="fas fa-fire"></i>
                        <div>
                            <h4>ç†±åŠ›åœ–åˆ†æ</h4>
                            <p>æŸ¥çœ‹æ•¸æ“šæ”¶é›†ç†±é»å€åŸŸ</p>
                        </div>
                    </div>
                    <div class="tool-item" id="export-map">
                        <i class="fas fa-download"></i>
                        <div>
                            <h4>å°å‡ºåœ°åœ–</h4>
                            <p>ä¿å­˜ç•¶å‰åŸå¸‚ä½ˆå±€</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ•¸æ“šåˆ†æé é¢ -->
        <div id="data-page" class="page">
            <div class="dashboard-header">
                <h2>æ•¸æ“šåˆ†æå„€è¡¨æ¿</h2>
                <div>
                    <button class="btn" id="refresh-data">åˆ·æ–°æ•¸æ“š</button>
                    <button class="btn btn-primary" id="export-data">å°å‡ºæ•¸æ“š</button>
                </div>
            </div>
            
            <div class="section-intro">
                <h3><i class="fas fa-chart-bar"></i> æ•¸æ“šåˆ†ææŒ‡å—</h3>
                <p>åœ¨æ­¤é é¢ç›£æ§å’Œåˆ†ææ‚¨çš„åŸå¸‚æ•¸æ“šã€‚ä½¿ç”¨åœ–è¡¨äº†è§£è¶¨å‹¢ï¼ŒæŸ¥çœ‹æ•ˆèƒ½æŒ‡æ¨™ï¼Œä¸¦æ ¹æ“šæ•¸æ“šåšå‡ºæ˜æ™ºæ±ºç­–ã€‚</p>
            </div>
            
            <div class="play-guide">
                <h3><i class="fas fa-chart-pie"></i> æ•¸æ“šåˆ†æç©æ³•</h3>
                <div class="play-guide-grid">
                    <div class="play-item">
                        <h4><i class="fas fa-search"></i> è¶¨å‹¢ç™¼ç¾</h4>
                        <p>åˆ†ææ•¸æ“šè¶¨å‹¢ï¼Œé æ¸¬æœªä¾†è®ŠåŒ–ï¼Œæå‰éƒ¨ç½²æ‡‰å°æªæ–½ã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-exclamation-circle"></i> ç•°å¸¸æª¢æ¸¬</h4>
                        <p>è­˜åˆ¥æ•¸æ“šç•°å¸¸ï¼ŒåŠæ™‚ç™¼ç¾ç³»çµ±å•é¡Œæˆ–æ„Ÿæ¸¬å™¨æ•…éšœã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-bullseye"></i> ç›®æ¨™è¿½è¹¤</h4>
                        <p>è¨­å®šæ•ˆèƒ½ç›®æ¨™ï¼Œè¿½è¹¤é€²åº¦ï¼Œç¢ºä¿åŸå¸‚é‹ä½œé”åˆ°é æœŸæ¨™æº–ã€‚</p>
                    </div>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-box">
                    <div class="chart-header">
                        <h3>æ„Ÿæ¸¬å™¨æ•¸æ“šæ¯”è¼ƒ</h3>
                        <select id="data-period">
                            <option value="day">éå»24å°æ™‚</option>
                            <option value="week">éå»7å¤©</option>
                            <option value="month">éå»30å¤©</option>
                        </select>
                    </div>
                    <div class="chart" id="sensor-chart">
                        <!-- åœ–è¡¨å°‡ç”±JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="chart-box">
                    <div class="chart-header">
                        <h3>èƒ½æºæ¶ˆè€—è¶¨å‹¢</h3>
                        <div>
                            <button class="btn btn-small" id="energy-day">æ—¥</button>
                            <button class="btn btn-small" id="energy-week">é€±</button>
                            <button class="btn btn-small active" id="energy-month">æœˆ</button>
                        </div>
                    </div>
                    <div class="chart" id="energy-chart">
                        <!-- åœ–è¡¨å°‡ç”±JavaScriptç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="chart-box">
                    <div class="chart-header">
                        <h3>ç³»çµ±æ•ˆèƒ½æŒ‡æ¨™</h3>
                    </div>
                    <div class="performance-metrics">
                        <div class="metric">
                            <div class="metric-label">å›æ‡‰æ™‚é–“</div>
                            <div class="metric-value" id="response-time">142ms</div>
                            <div class="metric-bar">
                                <div class="metric-fill" id="response-bar" style="width: 85%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">æ•¸æ“šæº–ç¢ºç‡</div>
                            <div class="metric-value" id="accuracy-rate">94.2%</div>
                            <div class="metric-bar">
                                <div class="metric-fill" id="accuracy-bar" style="width: 94%"></div>
                            </div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">ç³»çµ±å¯ç”¨æ€§</div>
                            <div class="metric-value" id="availability-rate">99.7%</div>
                            <div class="metric-bar">
                                <div class="metric-fill" id="availability-bar" style="width: 99%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="chart-box">
                    <div class="chart-header">
                        <h3>æ„Ÿæ¸¬å™¨åˆ†ä½ˆ</h3>
                    </div>
                    <div class="sensor-distribution">
                        <div class="distribution-item">
                            <div class="distribution-label">æº«åº¦æ„Ÿæ¸¬å™¨</div>
                            <div class="distribution-value" id="temp-count">3</div>
                            <div class="distribution-bar">
                                <div class="distribution-fill temperature" id="temp-bar" style="width: 37.5%"></div>
                            </div>
                        </div>
                        <div class="distribution-item">
                            <div class="distribution-label">äº¤é€šæ„Ÿæ¸¬å™¨</div>
                            <div class="distribution-value" id="traffic-count">2</div>
                            <div class="distribution-bar">
                                <div class="distribution-fill traffic" id="traffic-bar" style="width: 25%"></div>
                            </div>
                        </div>
                        <div class="distribution-item">
                            <div class="distribution-label">èƒ½æºæ„Ÿæ¸¬å™¨</div>
                            <div class="distribution-value" id="energy-count">2</div>
                            <div class="distribution-bar">
                                <div class="distribution-fill energy" id="energy-bar" style="width: 25%"></div>
                            </div>
                        </div>
                        <div class="distribution-item">
                            <div class="distribution-label">å®‰å…¨ç›£æ§</div>
                            <div class="distribution-value" id="security-count">1</div>
                            <div class="distribution-bar">
                                <div class="distribution-fill security" id="security-bar" style="width: 12.5%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="tool-panel">
                <h3><i class="fas fa-chart-line"></i> æ•¸æ“šåˆ†æå·¥å…·</h3>
                <div class="tool-grid">
                    <div class="tool-item" id="predictive-analytics">
                        <i class="fas fa-crystal-ball"></i>
                        <div>
                            <h4>é æ¸¬åˆ†æ</h4>
                            <p>åŸºæ–¼æ­·å²æ•¸æ“šé æ¸¬æœªä¾†è¶¨å‹¢</p>
                        </div>
                    </div>
                    <div class="tool-item" id="correlation-analysis">
                        <i class="fas fa-link"></i>
                        <div>
                            <h4>é—œè¯åˆ†æ</h4>
                            <p>åˆ†æä¸åŒæ•¸æ“šé–“çš„ç›¸é—œæ€§</p>
                        </div>
                    </div>
                    <div class="tool-item" id="anomaly-detection">
                        <i class="fas fa-radar"></i>
                        <div>
                            <h4>ç•°å¸¸æª¢æ¸¬</h4>
                            <p>è‡ªå‹•æª¢æ¸¬æ•¸æ“šç•°å¸¸æ¨¡å¼</p>
                        </div>
                    </div>
                    <div class="tool-item" id="custom-report">
                        <i class="fas fa-file-alt"></i>
                        <div>
                            <h4>è‡ªè¨‚å ±å‘Š</h4>
                            <p>å‰µå»ºå€‹æ€§åŒ–æ•¸æ“šå ±å‘Š</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç³»çµ±å„ªåŒ–é é¢ -->
        <div id="optimization-page" class="page">
            <div class="dashboard-header">
                <h2>ç³»çµ±å„ªåŒ–èˆ‡ç®¡ç†</h2>
                <div>
                    <button class="btn" id="run-optimization">åŸ·è¡Œå„ªåŒ–</button>
                    <button class="btn btn-primary" id="add-budget">å¢åŠ é ç®—</button>
                </div>
            </div>
            
            <div class="section-intro">
                <h3><i class="fas fa-tachometer-alt"></i> ç³»çµ±å„ªåŒ–æŒ‡å—</h3>
                <p>åœ¨æ­¤é é¢å„ªåŒ–æ‚¨çš„åŸå¸‚ç³»çµ±ã€‚å¹³è¡¡é ç®—èˆ‡æ•ˆèƒ½ï¼Œè™•ç†ç³»çµ±è­¦å ±ï¼Œå¯¦æ–½å„ªåŒ–å»ºè­°ï¼Œä¸¦é æ¸¬æœªä¾†æ•ˆèƒ½ã€‚</p>
            </div>
            
            <div class="play-guide">
                <h3><i class="fas fa-cogs"></i> ç³»çµ±å„ªåŒ–ç©æ³•</h3>
                <div class="play-guide-grid">
                    <div class="play-item">
                        <h4><i class="fas fa-chess-king"></i> ç­–ç•¥å„ªåŒ–</h4>
                        <p>åˆ¶å®šé•·æœŸå„ªåŒ–ç­–ç•¥ï¼Œå¹³è¡¡çŸ­æœŸæˆæœ¬èˆ‡é•·æœŸæ•ˆç›Šã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-first-aid"></i> æ•…éšœæ’é™¤</h4>
                        <p>å¿«é€Ÿè¨ºæ–·å’Œè§£æ±ºç³»çµ±å•é¡Œï¼Œæœ€å°åŒ–åœæ©Ÿæ™‚é–“ã€‚</p>
                    </div>
                    <div class="play-item">
                        <h4><i class="fas fa-chart-line"></i> æ•ˆèƒ½è¿½è¹¤</h4>
                        <p>ç›£æ§å„ªåŒ–æ•ˆæœï¼ŒæŒçºŒæ”¹é€²ç³»çµ±æ•ˆèƒ½ã€‚</p>
                    </div>
                </div>
            </div>
            
            <div class="optimization-panels">
                <div class="panel">
                    <h3>é ç®—ç®¡ç†</h3>
                    <p>ç®¡ç†æ‚¨çš„åŸå¸‚é ç®—ï¼Œå¹³è¡¡æ„Ÿæ¸¬å™¨éƒ¨ç½²èˆ‡ç³»çµ±ç¶­è­·æˆæœ¬ã€‚</p>
                    
                    <div class="budget-meter" style="margin: 1.5rem 0;">
                        <div class="budget-fill" id="optimization-budget-fill" style="width: 65%"></div>
                    </div>
                    
                    <div class="budget-details">
                        <div class="budget-item">
                            <span>æ„Ÿæ¸¬å™¨æˆæœ¬</span>
                            <span id="sensor-cost">$1,320</span>
                        </div>
                        <div class="budget-item">
                            <span>ç¶­è­·è²»ç”¨</span>
                            <span id="maintenance-cost">$480</span>
                        </div>
                        <div class="budget-item">
                            <span>èƒ½æºè²»ç”¨</span>
                            <span id="energy-cost">$150</span>
                        </div>
                        <div class="budget-item total">
                            <span>ç¸½æ”¯å‡º</span>
                            <span id="total-cost">$1,950</span>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>é ç®—å¥åº·åº¦</span>
                            <span id="budget-health">è‰¯å¥½</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill good" id="budget-health-bar" style="width: 75%"></div>
                        </div>
                    </div>
                </div>
                
                <div class="panel">
                    <h3>èƒ½æºæ¶ˆè€—å„ªåŒ–</h3>
                    <p>ç›£æ§å’Œå„ªåŒ–æ„Ÿæ¸¬å™¨ç¶²çµ¡çš„èƒ½æºæ¶ˆè€—ã€‚</p>
                    
                    <div class="energy-status">
                        <div class="energy-item">
                            <div class="energy-label">ç•¶å‰èƒ½è€—</div>
                            <div class="energy-value" id="current-energy">2.4 kW</div>
                        </div>
                        <div class="energy-item">
                            <div class="energy-label">ç›®æ¨™èƒ½è€—</div>
                            <div class="energy-value" id="target-energy">2.0 kW</div>
                        </div>
                        <div class="energy-item">
                            <div class="energy-label">ç¯€çœæ½›åŠ›</div>
                            <div class="energy-value" id="saving-potential">16.7%</div>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>èƒ½æºæ•ˆç‡</span>
                            <span id="energy-efficiency">83.3%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill warning" id="energy-efficiency-bar" style="width: 83.3%"></div>
                        </div>
                    </div>
                    
                    <div class="optimization-tips" style="margin-top: 1.5rem;">
                        <h4>å„ªåŒ–å»ºè­°:</h4>
                        <ul id="optimization-tips-list">
                            <!-- å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </ul>
                    </div>
                </div>
                
                <div class="panel">
                    <h3>ç³»çµ±è­¦å ±</h3>
                    <p>ç›£æ§ç³»çµ±ç‹€æ…‹ä¸¦è™•ç†æ½›åœ¨å•é¡Œã€‚é»æ“Šè­¦å ±æŸ¥çœ‹æ›´å¤šè©³æƒ…ã€‚</p>
                    
                    <div class="alert-list" id="alert-list">
                        <!-- è­¦å ±å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                    </div>
                    
                    <button class="btn" id="view-all-alerts" style="width: 100%; margin-top: 1.5rem;">æŸ¥çœ‹æ‰€æœ‰è­¦å ±</button>
                </div>
                
                <div class="panel">
                    <h3>æ•ˆèƒ½é æ¸¬</h3>
                    <p>åŸºæ–¼ç•¶å‰é…ç½®çš„ç³»çµ±æ•ˆèƒ½é æ¸¬ã€‚</p>
                    
                    <div class="prediction-chart">
                        <div class="prediction-item">
                            <div class="prediction-label">ç•¶å‰æ•ˆèƒ½</div>
                            <div class="prediction-value" id="current-performance">87%</div>
                            <div class="prediction-bar">
                                <div class="prediction-fill" id="current-performance-bar" style="width: 87%"></div>
                            </div>
                        </div>
                        <div class="prediction-item">
                            <div class="prediction-label">å„ªåŒ–å¾Œé æ¸¬</div>
                            <div class="prediction-value" id="predicted-performance">94%</div>
                            <div class="prediction-bar">
                                <div class="prediction-fill" id="predicted-performance-bar" style="width: 94%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>å„ªåŒ–æ½›åŠ›</span>
                            <span id="optimization-potential">7%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="optimization-potential-bar" style="width: 70%"></div>
                        </div>
                    </div>
                    
                    <div class="prediction-details" style="margin-top: 1.5rem;">
                        <h4>é æ¸¬æ”¹é€²:</h4>
                        <ul id="prediction-details-list">
                            <!-- å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="tool-panel">
                <h3><i class="fas fa-magic"></i> å„ªåŒ–å·¥å…·</h3>
                <div class="tool-grid">
                    <div class="tool-item" id="auto-optimize">
                        <i class="fas fa-robot"></i>
                        <div>
                            <h4>è‡ªå‹•å„ªåŒ–</h4>
                            <p>AIè‡ªå‹•åŸ·è¡Œæœ€ä½³å„ªåŒ–ç­–ç•¥</p>
                        </div>
                    </div>
                    <div class="tool-item" id="scenario-sim">
                        <i class="fas fa-vial"></i>
                        <div>
                            <h4>å ´æ™¯æ¨¡æ“¬</h4>
                            <p>æ¨¡æ“¬ä¸åŒå„ªåŒ–ç­–ç•¥çš„æ•ˆæœ</p>
                        </div>
                    </div>
                    <div class="tool-item" id="risk-assessment">
                        <i class="fas fa-shield-alt"></i>
                        <div>
                            <h4>é¢¨éšªè©•ä¼°</h4>
                            <p>è©•ä¼°ç³»çµ±è®Šæ›´çš„æ½›åœ¨é¢¨éšª</p>
                        </div>
                    </div>
                    <div class="tool-item" id="performance-audit">
                        <i class="fas fa-clipboard-check"></i>
                        <div>
                            <h4>æ•ˆèƒ½å¯©è¨ˆ</h4>
                            <p>å…¨é¢å¯©æŸ¥ç³»çµ±æ•ˆèƒ½ç‹€æ³</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- é è…³ -->
    <footer>
        <p>IoTæ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨ &copy; 2023 | ç§‘æŠ€æ•™è‚²å·¥å…· | è¨­è¨ˆèˆ‡é–‹ç™¼: Sam.T</p>
        <p>æ­¤ç‚ºæ•™è‚²ç”¨é€”çš„æ¨¡æ“¬å™¨ï¼Œå±•ç¤ºç‰©è¯ç¶²æŠ€è¡“åœ¨åŸå¸‚ç®¡ç†ä¸­çš„æ‡‰ç”¨</p>
        <div class="copyright">
            <p>ç‰ˆæ¬Šè²æ˜ Â© 2026 Create By ã€ Sam.T ã€‘</p>
            <p>Copyright Â© 2026 Sam.T. All rights reserved.</p>
            <p>ç‰ˆæ¬Šæ‰€æœ‰Â© 2026 Sam.T</p>
        </div>
    </footer>
    
    <!-- æ–°å¢æ„Ÿæ¸¬å™¨æ¨¡æ…‹æ¡† -->
    <div class="modal" id="sensor-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ–°å¢æ„Ÿæ¸¬å™¨</h3>
                <button class="close-modal" id="close-modal">&times;</button>
            </div>
            <form id="sensor-form">
                <div class="form-group">
                    <label for="sensor-type">æ„Ÿæ¸¬å™¨é¡å‹</label>
                    <select id="sensor-type" required>
                        <option value="">é¸æ“‡æ„Ÿæ¸¬å™¨é¡å‹</option>
                        <option value="temperature">æº«åº¦æ„Ÿæ¸¬å™¨</option>
                        <option value="traffic">äº¤é€šæ„Ÿæ¸¬å™¨</option>
                        <option value="energy">èƒ½æºæ„Ÿæ¸¬å™¨</option>
                        <option value="security">å®‰å…¨ç›£æ§</option>
                        <option value="water">æ°´è³ªç›£æ¸¬</option>
                        <option value="air">ç©ºæ°£å“è³ª</option>
                        <option value="waste">å»¢ç‰©ç®¡ç†</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="sensor-name">æ„Ÿæ¸¬å™¨åç¨±</label>
                    <input type="text" id="sensor-name" placeholder="ä¾‹å¦‚: ä¸­å¤®å…¬åœ’æº«åº¦æ„Ÿæ¸¬å™¨" required>
                </div>
                <div class="form-group">
                    <label for="sensor-location">éƒ¨ç½²ä½ç½®</label>
                    <select id="sensor-location" required>
                        <option value="">é¸æ“‡éƒ¨ç½²å€åŸŸ</option>
                        <option value="residential">ä½å®…å€</option>
                        <option value="commercial">å•†æ¥­å€</option>
                        <option value="industrial">å·¥æ¥­å€</option>
                        <option value="park">å…¬åœ’å€åŸŸ</option>
                        <option value="transportation">äº¤é€šæ¨ç´</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="sensor-config">å–æ¨£ç‡ (æ¯å°æ™‚)</label>
                    <select id="sensor-config" required>
                        <option value="10">ä½ (10æ¬¡/å°æ™‚)</option>
                        <option value="30" selected>ä¸­ (30æ¬¡/å°æ™‚)</option>
                        <option value="60">é«˜ (60æ¬¡/å°æ™‚)</option>
                        <option value="120">è¶…é«˜ (120æ¬¡/å°æ™‚)</option>
                    </select>
                </div>
                <div class="form-group">
                    <div class="cost-preview">
                        <p>é è¨ˆæˆæœ¬: <span id="cost-preview">$120</span></p>
                        <p>é è¨ˆèƒ½è€—: <span id="energy-preview">0.3kW</span></p>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="button" class="btn" id="cancel-sensor">å–æ¶ˆ</button>
                    <button type="submit" class="btn btn-primary">éƒ¨ç½²æ„Ÿæ¸¬å™¨</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- æ„Ÿæ¸¬å™¨è©³æƒ…æ¨¡æ…‹æ¡† -->
    <div class="modal" id="sensor-detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>æ„Ÿæ¸¬å™¨è©³æƒ…</h3>
                <button class="close-modal" id="close-detail-modal">&times;</button>
            </div>
            <div id="sensor-detail-content">
                <!-- å…§å®¹å°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button type="button" class="btn" id="close-detail-btn">é—œé–‰</button>
                <button type="button" class="btn btn-primary" id="configure-sensor">é…ç½®</button>
                <button type="button" class="btn btn-danger" id="remove-sensor">ç§»é™¤</button>
            </div>
        </div>
    </div>
    
    <!-- æ“ä½œæŒ‡å—æ¨¡æ…‹æ¡† -->
    <div class="modal" id="guide-modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-book"></i> å¹³å°æ“ä½œæŒ‡å—</h3>
                <button class="close-modal" id="close-guide-modal">&times;</button>
            </div>
            <div style="max-height: 600px; overflow-y: auto; padding-right: 10px;">
                <div class="guide-container" style="display: block; counter-reset: step-counter;">
                    <div class="guide-step">
                        <h3>æ­¥é©Ÿä¸€ï¼šäº†è§£åŸºæœ¬æ¦‚å¿µ</h3>
                        <p>æ™ºæ…§åŸå¸‚é€šéç‰©è¯ç¶²æ„Ÿæ¸¬å™¨æ”¶é›†æ•¸æ“šï¼Œå„ªåŒ–åŸå¸‚é‹ä½œã€‚æœ¬æ¨¡æ“¬å™¨è®“æ‚¨é«”é©—å¾é›¶é–‹å§‹å»ºè¨­æ™ºæ…§åŸå¸‚çš„éç¨‹ã€‚</p>
                        <div class="step-tip">
                            <h4>ğŸ“š å­¸ç¿’è¦é»</h4>
                            <p>â€¢ ç‰©è¯ç¶²æ„Ÿæ¸¬å™¨é¡å‹èˆ‡åŠŸèƒ½</p>
                            <p>â€¢ åŸå¸‚å€åŸŸåŠƒåˆ†èˆ‡æ„Ÿæ¸¬å™¨ä½ˆå±€</p>
                            <p>â€¢ æ•¸æ“šæ”¶é›†èˆ‡åˆ†æçš„é‡è¦æ€§</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <h3>æ­¥é©ŸäºŒï¼šéƒ¨ç½²æ„Ÿæ¸¬å™¨</h3>
                        <p>åœ¨ã€ŒåŸå¸‚ç®¡ç†ã€é é¢ï¼Œæ‹–æ”¾æ„Ÿæ¸¬å™¨åˆ°åŸå¸‚åœ°åœ–ä¸Šã€‚ä¸åŒå€åŸŸéœ€è¦ä¸åŒé¡å‹çš„æ„Ÿæ¸¬å™¨ä¾†æ”¶é›†æ•¸æ“šã€‚</p>
                        <div class="step-tip">
                            <h4>ğŸ¯ éƒ¨ç½²æŠ€å·§</h4>
                            <p>â€¢ ä½å®…å€ï¼šéƒ¨ç½²æº«åº¦ã€èƒ½æºæ„Ÿæ¸¬å™¨</p>
                            <p>â€¢ å•†æ¥­å€ï¼šéƒ¨ç½²äº¤é€šã€å®‰å…¨æ„Ÿæ¸¬å™¨</p>
                            <p>â€¢ å·¥æ¥­å€ï¼šéƒ¨ç½²èƒ½æºã€ç©ºæ°£å“è³ªæ„Ÿæ¸¬å™¨</p>
                            <p>â€¢ å…¬åœ’å€åŸŸï¼šéƒ¨ç½²æ°´è³ªã€ç’°å¢ƒæ„Ÿæ¸¬å™¨</p>
                            <p>â€¢ äº¤é€šæ¨ç´ï¼šéƒ¨ç½²äº¤é€šã€å®‰å…¨æ„Ÿæ¸¬å™¨</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <h3>æ­¥é©Ÿä¸‰ï¼šç›£æ§æ•¸æ“š</h3>
                        <p>åœ¨ã€Œæ•¸æ“šåˆ†æã€é é¢ï¼ŒæŸ¥çœ‹å„ç¨®æ„Ÿæ¸¬å™¨æ”¶é›†çš„æ•¸æ“šã€‚åœ–è¡¨å’ŒæŒ‡æ¨™å¹«åŠ©æ‚¨äº†è§£åŸå¸‚é‹ä½œç‹€æ…‹ã€‚</p>
                        <div class="step-tip">
                            <h4>ğŸ“Š ç›£æ§é‡é»</h4>
                            <p>â€¢ èƒ½æºæ¶ˆè€—è¶¨å‹¢åœ–ï¼šäº†è§£ç”¨é›»æ¨¡å¼</p>
                            <p>â€¢ ç³»çµ±æ•ˆèƒ½æŒ‡æ¨™ï¼šè¿½è¹¤ç³»çµ±å¥åº·ç‹€æ³</p>
                            <p>â€¢ æ„Ÿæ¸¬å™¨åˆ†ä½ˆçµ±è¨ˆï¼šç¢ºä¿å‡è¡¡è¦†è“‹</p>
                            <p>â€¢ æ•¸æ“šæº–ç¢ºç‡ï¼šç¢ºä¿æ•¸æ“šå¯é æ€§</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <h3>æ­¥é©Ÿå››ï¼šç³»çµ±å„ªåŒ–</h3>
                        <p>åœ¨ã€Œç³»çµ±å„ªåŒ–ã€é é¢ï¼Œæ ¹æ“šæ•¸æ“šåˆ†æçµæœé€²è¡Œç³»çµ±èª¿æ•´ã€‚å¹³è¡¡é ç®—ã€èƒ½æºæ¶ˆè€—èˆ‡ç³»çµ±æ•ˆèƒ½ã€‚</p>
                        <div class="step-tip">
                            <h4>âš™ï¸ å„ªåŒ–ç­–ç•¥</h4>
                            <p>â€¢ èª¿æ•´æ„Ÿæ¸¬å™¨å–æ¨£ç‡ï¼šå¹³è¡¡æ•¸æ“šè³ªé‡èˆ‡èƒ½è€—</p>
                            <p>â€¢ é‡æ–°åˆ†é…é ç®—ï¼šå„ªå…ˆæŠ•è³‡é«˜æ•ˆèƒ½å€åŸŸ</p>
                            <p>â€¢ è™•ç†ç³»çµ±è­¦å ±ï¼šåŠæ™‚è§£æ±ºæ½›åœ¨å•é¡Œ</p>
                            <p>â€¢ å¯¦æ–½å„ªåŒ–å»ºè­°ï¼šæ ¹æ“šAIå»ºè­°æ”¹é€²ç³»çµ±</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <h3>æ­¥é©Ÿäº”ï¼šæŒ‘æˆ°èˆ‡é€²éšç©æ³•</h3>
                        <p>å®ŒæˆåŸºæœ¬æ“ä½œå¾Œï¼Œå˜—è©¦å„ç¨®æŒ‘æˆ°ä»»å‹™å’Œé€²éšç©æ³•ï¼Œæå‡æ‚¨çš„åŸå¸‚ç®¡ç†æ°´å¹³ã€‚</p>
                        <div class="step-tip">
                            <h4>ğŸš€ é€²éšæŒ‘æˆ°</h4>
                            <p>â€¢ é ç®—é™åˆ¶æ¨¡å¼ï¼šåœ¨æœ‰é™é ç®—å…§é”æˆç›®æ¨™</p>
                            <p>â€¢ èƒ½æºæ•ˆç‡æŒ‘æˆ°ï¼šæœ€å¤§åŒ–èƒ½æºä½¿ç”¨æ•ˆç‡</p>
                            <p>â€¢ ç½é›£æ‡‰å°æ¨¡æ“¬ï¼šæ¸¬è©¦ç³»çµ±éŸŒæ€§</p>
                            <p>â€¢ æ™‚é–“é™åˆ¶æŒ‘æˆ°ï¼šåœ¨æ™‚é™å…§å®Œæˆä»»å‹™</p>
                        </div>
                    </div>
                    
                    <div class="guide-step">
                        <h3>æ­¥é©Ÿå…­ï¼šå·¥å…·èˆ‡è³‡æº</h3>
                        <p>åˆ©ç”¨å„ç¨®å·¥å…·å’Œè³‡æºä¾†æå‡ç®¡ç†æ•ˆç‡ã€‚æ¯å€‹é é¢éƒ½æœ‰å°ˆç”¨å·¥å…·å¹«åŠ©æ‚¨æ›´å¥½åœ°ç®¡ç†åŸå¸‚ã€‚</p>
                        <div class="step-tip">
                            <h4>ğŸ› ï¸ å¯ç”¨å·¥å…·</h4>
                            <p>â€¢ æ„Ÿæ¸¬å™¨é…ç½®å·¥å…·ï¼šæ‰¹é‡èª¿æ•´è¨­å®š</p>
                            <p>â€¢ æ•¸æ“šå°å‡ºåŠŸèƒ½ï¼šä¿å­˜åˆ†æçµæœ</p>
                            <p>â€¢ æ•ˆèƒ½é æ¸¬å·¥å…·ï¼šé æ¸¬æœªä¾†è¶¨å‹¢</p>
                            <p>â€¢ æ™ºèƒ½éƒ¨ç½²åŠ©æ‰‹ï¼šAIæ¨è–¦æœ€ä½³ä½ˆå±€</p>
                        </div>
                    </div>
                </div>
            </div>
            <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                <button type="button" class="btn" id="close-guide-btn">é—œé–‰</button>
                <button type="button" class="btn btn-primary" id="start-from-guide">é–‹å§‹æ¨¡æ“¬</button>
            </div>
        </div>
    </div>
    
    <!-- JavaScriptä»£ç¢¼ -->
    <script>
        'use strict';
        
        // å…¨å±€è®Šæ•¸
        let currentPage = 'home';
        let currentGameMode = 'normal';
        let sensors = [
            {id: 1, type: 'temperature', name: 'ä¸­å¤®å…¬åœ’æº«åº¦æ„Ÿæ¸¬å™¨', x: 1, y: 2, cost: 120, energy: 0.3, 
             status: 'active', dataRate: 30, lastUpdate: new Date(Date.now() - 300000), 
             battery: 85, signal: 92, location: 'park'},
            {id: 2, type: 'traffic', name: 'ä¸»è¡—äº¤é€šç›£æ§', x: 4, y: 3, cost: 200, energy: 0.5, 
             status: 'active', dataRate: 60, lastUpdate: new Date(Date.now() - 120000), 
             battery: 72, signal: 88, location: 'commercial'},
            {id: 3, type: 'energy', name: 'å•†æ¥­å€èƒ½æºç›£æ¸¬', x: 2, y: 5, cost: 180, energy: 0.4, 
             status: 'active', dataRate: 30, lastUpdate: new Date(Date.now() - 180000), 
             battery: 91, signal: 95, location: 'commercial'},
            {id: 4, type: 'security', name: 'å¸‚æ”¿åºœå®‰å…¨ç›£æ§', x: 5, y: 1, cost: 250, energy: 0.6, 
             status: 'active', dataRate: 120, lastUpdate: new Date(Date.now() - 60000), 
             battery: 65, signal: 85, location: 'commercial'},
            {id: 5, type: 'temperature', name: 'ä½å®…å€æº«åº¦ç›£æ¸¬', x: 3, y: 4, cost: 120, energy: 0.3, 
             status: 'active', dataRate: 10, lastUpdate: new Date(Date.now() - 240000), 
             battery: 78, signal: 90, location: 'residential'},
            {id: 6, type: 'traffic', name: 'é«˜é€Ÿå…¬è·¯æµé‡ç›£æ¸¬', x: 6, y: 2, cost: 200, energy: 0.5, 
             status: 'active', dataRate: 60, lastUpdate: new Date(Date.now() - 90000), 
             battery: 81, signal: 87, location: 'transportation'},
            {id: 7, type: 'energy', name: 'å·¥æ¥­å€ç”¨é›»ç›£æ¸¬', x: 1, y: 6, cost: 180, energy: 0.4, 
             status: 'active', dataRate: 30, lastUpdate: new Date(Date.now() - 150000), 
             battery: 69, signal: 83, location: 'industrial'},
            {id: 8, type: 'temperature', name: 'æ²³å²¸ç’°å¢ƒç›£æ¸¬', x: 5, y: 5, cost: 120, energy: 0.3, 
             status: 'warning', dataRate: 30, lastUpdate: new Date(Date.now() - 360000), 
             battery: 42, signal: 76, location: 'park'}
        ];
        
        let totalBudget = 3000;
        let usedBudget = 1950;
        let totalEnergy = 2.4;
        let systemAlerts = [];
        let optimizationHistory = [];
        let challenges = {
            cityPlanner: {completed: false, progress: 2, total: 5},
            energyExpert: {completed: false, progress: 2.4, target: 2.0},
            sensorMaster: {completed: true, progress: 5, total: 5}
        };
        
        // DOMå…ƒç´ ç·©å­˜
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const navLinks = document.getElementById('nav-links');
        const sensorModal = document.getElementById('sensor-modal');
        const sensorDetailModal = document.getElementById('sensor-detail-modal');
        const guideModal = document.getElementById('guide-modal');
        const closeModalBtn = document.getElementById('close-modal');
        const closeDetailModalBtn = document.getElementById('close-detail-modal');
        const closeGuideModalBtn = document.getElementById('close-guide-modal');
        const cancelSensorBtn = document.getElementById('cancel-sensor');
        const sensorForm = document.getElementById('sensor-form');
        const sensorTypeSelect = document.getElementById('sensor-type');
        const costPreview = document.getElementById('cost-preview');
        const energyPreview = document.getElementById('energy-preview');
        const guideBtn = document.getElementById('guide-btn');
        const guideContainer = document.getElementById('guide-container');
        const startFromGuideBtn = document.getElementById('start-from-guide');
        const closeGuideBtn = document.getElementById('close-guide-btn');
        
        // éŠæˆ²æ¨¡å¼åˆ‡æ›
        document.querySelectorAll('.mode-card').forEach(card => {
            card.addEventListener('click', function() {
                const mode = this.dataset.mode;
                
                // æ›´æ–°é¸ä¸­ç‹€æ…‹
                document.querySelectorAll('.mode-card').forEach(c => {
                    c.classList.remove('active');
                });
                this.classList.add('active');
                
                currentGameMode = mode;
                
                // æ ¹æ“šæ¨¡å¼èª¿æ•´åƒæ•¸
                switch(mode) {
                    case 'easy':
                        totalBudget = 5000;
                        break;
                    case 'normal':
                        totalBudget = 3000;
                        break;
                    case 'hard':
                        totalBudget = 1500;
                        break;
                    case 'creative':
                        totalBudget = 99999; // ç„¡é™é ç®—
                        break;
                }
                
                // æ›´æ–°é¡¯ç¤º
                updateStats();
                
                showNotification(`å·²åˆ‡æ›åˆ°${getModeName(mode)}æ¨¡å¼`, 'info');
            });
        });
        
        // ç²å–æ¨¡å¼åç¨±
        function getModeName(mode) {
            switch(mode) {
                case 'easy': return 'åˆå­¸è€…';
                case 'normal': return 'æ¨™æº–';
                case 'hard': return 'å°ˆå®¶';
                case 'creative': return 'å‰µæ„';
                default: return 'æ¨™æº–';
            }
        }
        
        // æ“ä½œæŒ‡å—æŒ‰éˆ•
        guideBtn.addEventListener('click', function() {
            guideModal.classList.add('active');
        });
        
        closeGuideModalBtn.addEventListener('click', function() {
            guideModal.classList.remove('active');
        });
        
        closeGuideBtn.addEventListener('click', function() {
            guideModal.classList.remove('active');
        });
        
        startFromGuideBtn.addEventListener('click', function() {
            guideModal.classList.remove('active');
            document.querySelector('[data-page="city"]').click();
            showNotification('æ­¡è¿ä½¿ç”¨æ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨ï¼é–‹å§‹éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€å€‹æ„Ÿæ¸¬å™¨å§ã€‚', 'success');
        });
        
        // å·¥å…·æŒ‰éˆ•äº‹ä»¶
        document.querySelectorAll('.tool-item').forEach(tool => {
            tool.addEventListener('click', function() {
                if (this.classList.contains('disabled')) return;
                
                const toolId = this.id;
                showNotification(`å·²å•Ÿå‹• ${this.querySelector('h4').textContent} åŠŸèƒ½`, 'info');
                
                // æ ¹æ“šå·¥å…·IDåŸ·è¡Œç›¸æ‡‰åŠŸèƒ½
                switch(toolId) {
                    case 'auto-deploy':
                        autoDeploySensors();
                        break;
                    case 'heatmap':
                        showHeatmap();
                        break;
                    case 'export-map':
                        exportCityMap();
                        break;
                    case 'predictive-analytics':
                        showPredictiveAnalytics();
                        break;
                    case 'auto-optimize':
                        autoOptimizeSystem();
                        break;
                    case 'scenario-sim':
                        showScenarioSimulation();
                        break;
                    default:
                        // å…¶ä»–å·¥å…·é¡¯ç¤ºåŠŸèƒ½æç¤º
                        const toolName = this.querySelector('h4').textContent;
                        alert(`${toolName}åŠŸèƒ½\n\næ­¤åŠŸèƒ½å°‡åœ¨å®Œæ•´ç‰ˆæœ¬ä¸­æä¾›æ›´è©³ç´°çš„åŠŸèƒ½ã€‚\n\nç›®å‰ç‰ˆæœ¬æ”¯æ´ï¼š\nâ€¢ åŸºæœ¬æ„Ÿæ¸¬å™¨éƒ¨ç½²\nâ€¢ æ•¸æ“šç›£æ§èˆ‡åˆ†æ\nâ€¢ ç³»çµ±å„ªåŒ–å»ºè­°\nâ€¢ æŒ‘æˆ°ä»»å‹™å®Œæˆ`);
                }
            });
        });
        
        // è‡ªå‹•éƒ¨ç½²æ„Ÿæ¸¬å™¨
        function autoDeploySensors() {
            const emptyCells = document.querySelectorAll('.grid-cell:not(.occupied)');
            if (emptyCells.length === 0) {
                showNotification('åŸå¸‚åœ°åœ–å·²æ»¿ï¼Œç„¡æ³•è‡ªå‹•éƒ¨ç½²', 'warning');
                return;
            }
            
            // éš¨æ©Ÿé¸æ“‡å¹¾å€‹ç©ºå–®å…ƒæ ¼éƒ¨ç½²æ„Ÿæ¸¬å™¨
            const deployments = Math.min(3, emptyCells.length);
            const sensorTypes = ['temperature', 'traffic', 'energy', 'security', 'water', 'air', 'waste'];
            
            let deployedCount = 0;
            
            for (let i = 0; i < deployments; i++) {
                const randomCell = emptyCells[Math.floor(Math.random() * emptyCells.length)];
                const randomType = sensorTypes[Math.floor(Math.random() * sensorTypes.length)];
                
                let cost, energy;
                switch(randomType) {
                    case 'temperature': cost = 120; energy = 0.3; break;
                    case 'traffic': cost = 200; energy = 0.5; break;
                    case 'energy': cost = 180; energy = 0.4; break;
                    case 'security': cost = 250; energy = 0.6; break;
                    case 'water': cost = 220; energy = 0.4; break;
                    case 'air': cost = 190; energy = 0.35; break;
                    case 'waste': cost = 170; energy = 0.3; break;
                    default: cost = 150; energy = 0.4;
                }
                
                const x = parseInt(randomCell.dataset.x);
                const y = parseInt(randomCell.dataset.y);
                
                if (addNewSensor(randomType, cost, energy, x, y)) {
                    deployedCount++;
                }
            }
            
            showNotification(`AIå·²è‡ªå‹•éƒ¨ç½² ${deployedCount} å€‹æ„Ÿæ¸¬å™¨`, 'success');
        }
        
        // é¡¯ç¤ºç†±åŠ›åœ–
        function showHeatmap() {
            const cells = document.querySelectorAll('.grid-cell');
            cells.forEach(cell => {
                cell.style.backgroundColor = '';
            });
            
            // ç‚ºæ¯å€‹æœ‰æ„Ÿæ¸¬å™¨çš„å–®å…ƒæ ¼æ·»åŠ ç†±åŠ›åœ–æ•ˆæœ
            sensors.forEach(sensor => {
                const cell = document.querySelector(`.grid-cell[data-x="${sensor.x}"][data-y="${sensor.y}"]`);
                if (cell) {
                    // æ ¹æ“šæ„Ÿæ¸¬å™¨é¡å‹è¨­å®šé¡è‰²å¼·åº¦
                    let intensity = 0.3;
                    if (sensor.dataRate > 60) intensity = 0.7;
                    else if (sensor.dataRate > 30) intensity = 0.5;
                    
                    if (sensor.type === 'temperature') {
                        cell.style.backgroundColor = `rgba(255, 107, 107, ${intensity})`;
                    } else if (sensor.type === 'traffic') {
                        cell.style.backgroundColor = `rgba(78, 205, 196, ${intensity})`;
                    } else if (sensor.type === 'energy') {
                        cell.style.backgroundColor = `rgba(255, 230, 109, ${intensity})`;
                    } else if (sensor.type === 'security') {
                        cell.style.backgroundColor = `rgba(157, 78, 221, ${intensity})`;
                    }
                }
            });
            
            showNotification('ç†±åŠ›åœ–å·²é¡¯ç¤º - é¡è‰²è¡¨ç¤ºæ•¸æ“šæ”¶é›†å¼·åº¦', 'info');
            
            // 5ç§’å¾Œæ¢å¾©åŸç‹€
            setTimeout(() => {
                cells.forEach(cell => {
                    cell.style.backgroundColor = '';
                });
            }, 5000);
        }
        
        // å°å‡ºåŸå¸‚åœ°åœ–
        function exportCityMap() {
            const mapData = {
                sensors: sensors.map(s => ({
                    type: s.type,
                    name: s.name,
                    x: s.x,
                    y: s.y,
                    location: s.location
                })),
                timestamp: new Date().toISOString(),
                gameMode: currentGameMode
            };
            
            const dataStr = JSON.stringify(mapData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const url = URL.createObjectURL(dataBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ™ºæ…§åŸå¸‚åœ°åœ–_${new Date().toISOString().slice(0,10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('åŸå¸‚åœ°åœ–å·²å°å‡ºç‚ºJSONæ–‡ä»¶ï¼', 'success');
        }
        
        // é¡¯ç¤ºé æ¸¬åˆ†æ
        function showPredictiveAnalytics() {
            const predictions = {
                energy: {
                    current: sensors.reduce((sum, s) => sum + s.energy, 0),
                    predicted: sensors.reduce((sum, s) => sum + s.energy * 0.9, 0) // é æ¸¬é™ä½10%
                },
                efficiency: {
                    current: calculateSystemPerformance(),
                    predicted: Math.min(calculateSystemPerformance() + 8, 100)
                },
                cost: {
                    current: usedBudget,
                    predicted: usedBudget * 1.1 // é æ¸¬æˆæœ¬å¢åŠ 10%
                }
            };
            
            const message = `é æ¸¬åˆ†æçµæœï¼š\n\n` +
                          `èƒ½æºæ¶ˆè€—ï¼š${predictions.energy.current.toFixed(1)}kW â†’ ${predictions.energy.predicted.toFixed(1)}kW\n` +
                          `ç³»çµ±æ•ˆèƒ½ï¼š${predictions.efficiency.current}% â†’ ${predictions.efficiency.predicted}%\n` +
                          `ç¸½æˆæœ¬ï¼š$${Math.round(predictions.cost.current)} â†’ $${Math.round(predictions.cost.predicted)}\n\n` +
                          `åŸºæ–¼æ­·å²æ•¸æ“šå’Œç•¶å‰è¶¨å‹¢çš„é æ¸¬ï¼Œåƒ…ä¾›åƒè€ƒã€‚`;
            
            alert(message);
        }
        
        // è‡ªå‹•å„ªåŒ–ç³»çµ±
        function autoOptimizeSystem() {
            let optimizations = 0;
            
            // å„ªåŒ–ä½å–æ¨£ç‡çš„æ„Ÿæ¸¬å™¨
            sensors.forEach(sensor => {
                if (sensor.dataRate > 60 && sensor.status === 'active') {
                    const oldRate = sensor.dataRate;
                    sensor.dataRate = 60;
                    sensor.energy = sensor.energy * (60 / oldRate);
                    optimizations++;
                    
                    addAlert({
                        type: 'info',
                        title: `${sensor.name} å–æ¨£ç‡å„ªåŒ–`,
                        message: `å–æ¨£ç‡å¾ ${oldRate} èª¿æ•´ç‚º 60 æ¬¡/å°æ™‚`,
                        sensorId: sensor.id,
                        resolved: true
                    });
                }
            });
            
            // ä¿®å¾©è­¦å‘Šç‹€æ…‹çš„æ„Ÿæ¸¬å™¨
            sensors.forEach(sensor => {
                if (sensor.status === 'warning' && sensor.battery < 50) {
                    sensor.battery = 80;
                    sensor.status = 'active';
                    optimizations++;
                    
                    addAlert({
                        type: 'success',
                        title: `${sensor.name} é›»æ± å……é›»`,
                        message: 'é›»æ± å·²å……é›»è‡³80%ï¼Œç‹€æ…‹æ¢å¾©æ­£å¸¸',
                        sensorId: sensor.id,
                        resolved: true
                    });
                }
            });
            
            if (optimizations > 0) {
                updateStats();
                showNotification(`è‡ªå‹•å„ªåŒ–å®Œæˆï¼åŸ·è¡Œäº† ${optimizations} é …å„ªåŒ–`, 'success');
            } else {
                showNotification('ç³»çµ±å·²å„ªåŒ–è‰¯å¥½ï¼Œç„¡éœ€è‡ªå‹•å„ªåŒ–', 'info');
            }
        }
        
        // é¡¯ç¤ºå ´æ™¯æ¨¡æ“¬
        function showScenarioSimulation() {
            const scenarios = [
                {
                    name: 'ç¯€èƒ½å ´æ™¯',
                    description: 'å°‡æ‰€æœ‰æ„Ÿæ¸¬å™¨å–æ¨£ç‡é™ä½20%',
                    effect: 'èƒ½æºæ¶ˆè€—é™ä½15%ï¼Œæ•¸æ“šæº–ç¢ºç‡é™ä½5%'
                },
                {
                    name: 'é«˜æ•ˆèƒ½å ´æ™¯',
                    description: 'å°‡é—œéµæ„Ÿæ¸¬å™¨å–æ¨£ç‡æé«˜50%',
                    effect: 'æ•¸æ“šæº–ç¢ºç‡æé«˜10%ï¼Œèƒ½æºæ¶ˆè€—å¢åŠ 20%'
                },
                {
                    name: 'æˆæœ¬æ§åˆ¶å ´æ™¯',
                    description: 'ç§»é™¤20%çš„éé—œéµæ„Ÿæ¸¬å™¨',
                    effect: 'æˆæœ¬é™ä½25%ï¼Œç³»çµ±æ•ˆèƒ½é™ä½8%'
                }
            ];
            
            let scenarioText = 'å ´æ™¯æ¨¡æ“¬é¸é …ï¼š\n\n';
            scenarios.forEach((scenario, index) => {
                scenarioText += `${index + 1}. ${scenario.name}\n`;
                scenarioText += `   æè¿°ï¼š${scenario.description}\n`;
                scenarioText += `   æ•ˆæœï¼š${scenario.effect}\n\n`;
            });
            
            scenarioText += 'é¸æ“‡å ´æ™¯é€²è¡Œæ¨¡æ“¬ï¼ˆè¼¸å…¥æ•¸å­—ï¼‰ï¼š';
            
            const choice = prompt(scenarioText);
            if (choice && ['1', '2', '3'].includes(choice)) {
                const selectedScenario = scenarios[parseInt(choice) - 1];
                showNotification(`æ­£åœ¨æ¨¡æ“¬ã€Œ${selectedScenario.name}ã€...`, 'info');
                
                // æ¨¡æ“¬å»¶é²æ•ˆæœ
                setTimeout(() => {
                    showNotification(`ã€Œ${selectedScenario.name}ã€æ¨¡æ“¬å®Œæˆï¼æ•ˆæœï¼š${selectedScenario.effect}`, 'success');
                }, 2000);
            }
        }
        
        // é é¢åˆ‡æ›åŠŸèƒ½
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const pageId = this.getAttribute('data-page');
                
                // æ›´æ–°å°èˆªç‹€æ…‹
                document.querySelectorAll('.nav-link').forEach(nav => nav.classList.remove('active'));
                this.classList.add('active');
                
                // åˆ‡æ›é é¢
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.getElementById(`${pageId}-page`).classList.add('active');
                
                currentPage = pageId;
                
                // é—œé–‰è¡Œå‹•è£ç½®é¸å–®
                if (navLinks.classList.contains('active')) {
                    navLinks.classList.remove('active');
                }
                
                // å¦‚æœåˆ‡æ›åˆ°åŸå¸‚é é¢ï¼Œåˆå§‹åŒ–åœ°åœ–
                if (pageId === 'city') {
                    initializeCityGrid();
                    updateStats();
                    updateChallenges();
                }
                
                // å¦‚æœåˆ‡æ›åˆ°æ•¸æ“šé é¢ï¼Œåˆå§‹åŒ–åœ–è¡¨
                if (pageId === 'data') {
                    initializeCharts();
                    updateDistributionChart();
                    updatePerformanceMetrics();
                }
                
                // å¦‚æœåˆ‡æ›åˆ°å„ªåŒ–é é¢ï¼Œæ›´æ–°æ•¸æ“š
                if (pageId === 'optimization') {
                    updateOptimizationPage();
                    updateAlertsDisplay();
                    updateOptimizationTips();
                }
            });
        });
        
        // è¡Œå‹•è£ç½®é¸å–®åˆ‡æ›
        mobileMenuBtn.addEventListener('click', function() {
            navLinks.classList.toggle('active');
        });
        
        // åˆå§‹åŒ–åŸå¸‚ç¶²æ ¼
        function initializeCityGrid() {
            const grid = document.getElementById('city-grid');
            grid.innerHTML = '';
            
            // å‰µå»º6x6ç¶²æ ¼
            for (let row = 1; row <= 6; row++) {
                for (let col = 1; col <= 6; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'grid-cell';
                    cell.dataset.x = col;
                    cell.dataset.y = row;
                    
                    // æª¢æŸ¥æ˜¯å¦æœ‰æ„Ÿæ¸¬å™¨åœ¨é€™å€‹ä½ç½®
                    const sensorInCell = sensors.find(s => s.x == col && s.y == row);
                    if (sensorInCell) {
                        cell.classList.add('occupied');
                        const sensor = createSensorElement(sensorInCell);
                        cell.appendChild(sensor);
                    }
                    
                    // æ·»åŠ æ”¾ç½®äº‹ä»¶
                    cell.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        this.classList.add('hover');
                    });
                    
                    cell.addEventListener('dragleave', function() {
                        this.classList.remove('hover');
                    });
                    
                    cell.addEventListener('drop', function(e) {
                        e.preventDefault();
                        this.classList.remove('hover');
                        
                        const sensorType = e.dataTransfer.getData('sensorType');
                        const sensorCost = parseInt(e.dataTransfer.getData('sensorCost'));
                        const sensorEnergy = parseFloat(e.dataTransfer.getData('sensorEnergy'));
                        const sensorId = e.dataTransfer.getData('sensorId');
                        
                        // å¦‚æœæ˜¯ç§»å‹•ç¾æœ‰æ„Ÿæ¸¬å™¨
                        if (sensorId) {
                            moveSensor(parseInt(sensorId), parseInt(this.dataset.x), parseInt(this.dataset.y));
                            return;
                        }
                        
                        // å¦‚æœæ˜¯æ–°å¢æ„Ÿæ¸¬å™¨
                        if (sensorType && !this.classList.contains('occupied')) {
                            addNewSensor(sensorType, sensorCost, sensorEnergy, 
                                        parseInt(this.dataset.x), parseInt(this.dataset.y));
                        }
                    });
                    
                    grid.appendChild(cell);
                }
            }
        }
        
        // å‰µå»ºæ„Ÿæ¸¬å™¨å…ƒç´ 
        function createSensorElement(sensor) {
            const sensorContainer = document.createElement('div');
            sensorContainer.style.position = 'relative';
            
            const sensorElement = document.createElement('div');
            sensorElement.className = `sensor ${sensor.type}`;
            sensorElement.dataset.id = sensor.id;
            sensorElement.dataset.type = sensor.type;
            sensorElement.innerHTML = `<i class="${getSensorIcon(sensor.type)}"></i>`;
            
            // æ·»åŠ æ„Ÿæ¸¬å™¨è³‡è¨Šæç¤º
            const infoDiv = document.createElement('div');
            infoDiv.className = 'sensor-info';
            infoDiv.innerHTML = `
                <strong>${sensor.name}</strong><br>
                ç‹€æ…‹: ${getStatusText(sensor.status)}<br>
                é›»é‡: ${sensor.battery}%
            `;
            sensorElement.appendChild(infoDiv);
            
            const label = document.createElement('div');
            label.className = 'sensor-label';
            label.textContent = sensor.name.substring(0, 6);
            
            // æ·»åŠ é»æ“ŠæŸ¥çœ‹è©³æƒ…åŠŸèƒ½
            sensorElement.addEventListener('click', function(e) {
                e.stopPropagation();
                showSensorDetail(sensor.id);
            });
            
            // æ·»åŠ æ‹–å‹•äº‹ä»¶
            sensorElement.setAttribute('draggable', 'true');
            sensorElement.addEventListener('dragstart', function(e) {
                e.dataTransfer.setData('sensorId', sensor.id);
                e.dataTransfer.setData('sensorType', sensor.type);
                e.dataTransfer.setData('sensorCost', sensor.cost);
                e.dataTransfer.setData('sensorEnergy', sensor.energy);
            });
            
            sensorContainer.appendChild(sensorElement);
            sensorContainer.appendChild(label);
            
            return sensorContainer;
        }
        
        // é¡¯ç¤ºæ„Ÿæ¸¬å™¨è©³æƒ…
        function showSensorDetail(sensorId) {
            const sensor = sensors.find(s => s.id === sensorId);
            if (!sensor) return;
            
            const detailContent = document.getElementById('sensor-detail-content');
            detailContent.innerHTML = `
                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem;">
                    <div class="sensor ${sensor.type}" style="width: 60px; height: 60px;">
                        <i class="${getSensorIcon(sensor.type)}"></i>
                    </div>
                    <div>
                        <h3>${sensor.name}</h3>
                        <p>é¡å‹: ${getSensorName(sensor.type)}</p>
                    </div>
                </div>
                
                <div class="sensor-details">
                    <div class="detail-row">
                        <span>ç‹€æ…‹:</span>
                        <span class="status-${sensor.status}">${getStatusText(sensor.status)}</span>
                    </div>
                    <div class="detail-row">
                        <span>ä½ç½®:</span>
                        <span>(${sensor.x}, ${sensor.y}) - ${getLocationName(sensor.location)}</span>
                    </div>
                    <div class="detail-row">
                        <span>æˆæœ¬:</span>
                        <span>$${sensor.cost}</span>
                    </div>
                    <div class="detail-row">
                        <span>èƒ½è€—:</span>
                        <span>${sensor.energy}kW</span>
                    </div>
                    <div class="detail-row">
                        <span>å–æ¨£ç‡:</span>
                        <span>${sensor.dataRate}æ¬¡/å°æ™‚</span>
                    </div>
                    <div class="detail-row">
                        <span>é›»é‡:</span>
                        <span>${sensor.battery}%</span>
                    </div>
                    <div class="detail-row">
                        <span>ä¿¡è™Ÿå¼·åº¦:</span>
                        <span>${sensor.signal}%</span>
                    </div>
                    <div class="detail-row">
                        <span>æœ€å¾Œæ›´æ–°:</span>
                        <span>${formatTime(sensor.lastUpdate)}</span>
                    </div>
                </div>
                
                <style>
                    .sensor-details {
                        display: grid;
                        gap: 0.5rem;
                    }
                    .detail-row {
                        display: flex;
                        justify-content: space-between;
                        padding: 0.5rem 0;
                        border-bottom: 1px solid rgba(100, 255, 218, 0.1);
                    }
                    .detail-row:last-child {
                        border-bottom: none;
                    }
                    .status-active { color: var(--success); }
                    .status-warning { color: var(--warning); }
                    .status-inactive { color: var(--text-secondary); }
                </style>
            `;
            
            // è¨­ç½®ç§»é™¤æŒ‰éˆ•äº‹ä»¶
            const removeBtn = document.getElementById('remove-sensor');
            removeBtn.onclick = function() {
                if (confirm(`ç¢ºå®šè¦ç§»é™¤ ${sensor.name} å—ï¼Ÿ`)) {
                    deleteSensor(sensor.id);
                    sensorDetailModal.classList.remove('active');
                }
            };
            
            // è¨­ç½®é…ç½®æŒ‰éˆ•äº‹ä»¶
            const configBtn = document.getElementById('configure-sensor');
            configBtn.onclick = function() {
                const newRate = prompt(`èª¿æ•´ ${sensor.name} çš„å–æ¨£ç‡ (ç•¶å‰: ${sensor.dataRate}æ¬¡/å°æ™‚)`, sensor.dataRate);
                if (newRate && !isNaN(newRate) && newRate >= 1 && newRate <= 240) {
                    const oldRate = sensor.dataRate;
                    sensor.dataRate = parseInt(newRate);
                    sensor.energy = sensor.energy * (sensor.dataRate / oldRate);
                    
                    updateStats();
                    sensorDetailModal.classList.remove('active');
                    showNotification(`${sensor.name} å–æ¨£ç‡å·²èª¿æ•´ç‚º ${sensor.dataRate}æ¬¡/å°æ™‚`, 'success');
                }
            };
            
            sensorDetailModal.classList.add('active');
        }
        
        // æ–°å¢æ„Ÿæ¸¬å™¨
        function addNewSensor(type, baseCost, baseEnergy, x, y) {
            const config = document.getElementById('sensor-config');
            const dataRate = config ? parseInt(config.value) : 30;
            const location = document.getElementById('sensor-location');
            const locationValue = location ? location.value : 'residential';
            const nameInput = document.getElementById('sensor-name');
            const sensorName = nameInput && nameInput.value.trim() !== '' ? 
                nameInput.value : `${getSensorName(type)} ${sensors.length + 1}`;
            
            // æ ¹æ“šå–æ¨£ç‡èª¿æ•´æˆæœ¬å’Œèƒ½æºæ¶ˆè€—
            const costMultiplier = dataRate / 30;
            const energyMultiplier = dataRate / 30;
            
            const cost = Math.round(baseCost * costMultiplier);
            const energy = parseFloat((baseEnergy * energyMultiplier).toFixed(2));
            
            // è¨ˆç®—ç¶­è­·æˆæœ¬
            const maintenanceCost = cost * 0.25;
            const totalCost = cost + maintenanceCost;
            
            // æª¢æŸ¥é ç®—
            if (usedBudget + totalCost > totalBudget) {
                showNotification('é ç®—ä¸è¶³ï¼ç„¡æ³•éƒ¨ç½²æ›´å¤šæ„Ÿæ¸¬å™¨ã€‚', 'warning');
                return false;
            }
            
            // æª¢æŸ¥ç³»çµ±è² è¼‰
            const systemLoad = calculateSystemLoad();
            if (systemLoad > 90) {
                showNotification('ç³»çµ±è² è¼‰éé«˜ï¼è«‹å…ˆå„ªåŒ–ç¾æœ‰æ„Ÿæ¸¬å™¨ã€‚', 'warning');
                return false;
            }
            
            // å‰µå»ºæ–°æ„Ÿæ¸¬å™¨
            const sensorId = sensors.length > 0 ? Math.max(...sensors.map(s => s.id)) + 1 : 1;
            
            const newSensor = {
                id: sensorId,
                type: type,
                name: sensorName,
                x: x,
                y: y,
                cost: cost,
                energy: energy,
                status: 'active',
                dataRate: dataRate,
                lastUpdate: new Date(),
                battery: 100,
                signal: 95,
                location: locationValue
            };
            
            sensors.push(newSensor);
            
            // æ›´æ–°UI
            const cell = document.querySelector(`.grid-cell[data-x="${x}"][data-y="${y}"]`);
            if (cell) {
                cell.classList.add('occupied');
                const sensorElement = createSensorElement(newSensor);
                cell.appendChild(sensorElement);
            }
            
            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            updateStats();
            
            // æ›´æ–°æŒ‘æˆ°é€²åº¦
            updateChallenges();
            
            // é¡¯ç¤ºæˆåŠŸæ¶ˆæ¯
            showNotification(`æˆåŠŸéƒ¨ç½² ${sensorName}ï¼æˆæœ¬: $${cost}, èƒ½è€—: ${energy}kW`, 'success');
            
            // éš¨æ©Ÿç”Ÿæˆä¸€å€‹è­¦å ±
            if (Math.random() > 0.7) {
                const alertTypes = ['info', 'warning'];
                const alertType = alertTypes[Math.floor(Math.random() * alertTypes.length)];
                const alertMessages = [
                    'æ–°æ„Ÿæ¸¬å™¨éƒ¨ç½²å®Œæˆï¼Œéœ€è¦åˆå§‹æ ¡æº–',
                    'æ–°æ„Ÿæ¸¬å™¨ç¶²çµ¡é€£æ¥æ¸¬è©¦ä¸­',
                    'æ–°æ„Ÿæ¸¬å™¨æ•¸æ“šå‚³è¼¸æ­£å¸¸'
                ];
                
                addAlert({
                    type: alertType,
                    title: `${sensorName} éƒ¨ç½²å®Œæˆ`,
                    message: alertMessages[Math.floor(Math.random() * alertMessages.length)],
                    sensorId: sensorId,
                    resolved: false
                });
            }
            
            return true;
        }
        
        // æ›´æ–°æŒ‘æˆ°é€²åº¦
        function updateChallenges() {
            // æŒ‘æˆ°1: åŸå¸‚è¦åŠƒå¸« - åœ¨æ¯å€‹å€åŸŸè‡³å°‘éƒ¨ç½²1å€‹æ„Ÿæ¸¬å™¨
            const locations = sensors.map(s => s.location);
            const uniqueLocations = [...new Set(locations)];
            challenges.cityPlanner.progress = uniqueLocations.length;
            challenges.cityPlanner.completed = uniqueLocations.length >= 5;
            
            // æŒ‘æˆ°2: ç¯€èƒ½å°ˆå®¶ - å°‡ç¸½èƒ½æºæ¶ˆè€—æ§åˆ¶åœ¨2.0kWä»¥ä¸‹
            const totalEnergy = sensors.reduce((sum, s) => sum + s.energy, 0);
            challenges.energyExpert.progress = totalEnergy;
            challenges.energyExpert.completed = totalEnergy <= 2.0;
            
            // æŒ‘æˆ°3: æ„Ÿæ¸¬å™¨å¤§å¸« - éƒ¨ç½²è‡³å°‘5å€‹ä¸åŒé¡å‹çš„æ„Ÿæ¸¬å™¨
            const sensorTypes = sensors.map(s => s.type);
            const uniqueTypes = [...new Set(sensorTypes)];
            challenges.sensorMaster.progress = uniqueTypes.length;
            challenges.sensorMaster.completed = uniqueTypes.length >= 5;
            
            // æ›´æ–°æŒ‘æˆ°é¡¯ç¤º
            document.getElementById('challenge1-progress').textContent = 
                `${challenges.cityPlanner.progress}/5`;
            document.getElementById('challenge1').querySelector('.progress-fill').style.width = 
                `${(challenges.cityPlanner.progress / 5) * 100}%`;
                
            document.getElementById('challenge2-progress').textContent = 
                `${totalEnergy.toFixed(1)}/2.0kW`;
            document.getElementById('challenge2').querySelector('.progress-fill').style.width = 
                `${Math.min((totalEnergy / 2.0) * 100, 100)}%`;
                
            // æ›´æ–°æŒ‘æˆ°å¡æ¨£å¼
            document.getElementById('challenge1').classList.toggle('completed', challenges.cityPlanner.completed);
            document.getElementById('challenge2').classList.toggle('completed', challenges.energyExpert.completed);
            document.getElementById('challenge3').classList.toggle('completed', challenges.sensorMaster.completed);
            
            // æª¢æŸ¥æ˜¯å¦æœ‰æ–°å®Œæˆçš„æŒ‘æˆ°
            if (challenges.cityPlanner.completed && !challenges.cityPlanner.rewarded) {
                challenges.cityPlanner.rewarded = true;
                totalBudget += 500;
                showNotification('ğŸ‰ æŒ‘æˆ°å®Œæˆï¼šåŸå¸‚è¦åŠƒå¸«ï¼ç²å¾—$500çå‹µ', 'success');
            }
            
            if (challenges.energyExpert.completed && !challenges.energyExpert.rewarded) {
                challenges.energyExpert.rewarded = true;
                totalBudget += 300;
                showNotification('ğŸ‰ æŒ‘æˆ°å®Œæˆï¼šç¯€èƒ½å°ˆå®¶ï¼ç²å¾—$300çå‹µ', 'success');
            }
        }
        
        // ç§»å‹•æ„Ÿæ¸¬å™¨
        function moveSensor(sensorId, newX, newY) {
            const sensorIndex = sensors.findIndex(s => s.id === sensorId);
            if (sensorIndex === -1) return;
            
            // æª¢æŸ¥æ–°ä½ç½®æ˜¯å¦å·²è¢«ä½”ç”¨
            const existingSensor = sensors.find(s => s.x === newX && s.y === newY);
            if (existingSensor && existingSensor.id !== sensorId) {
                showNotification('è©²ä½ç½®å·²è¢«å…¶ä»–æ„Ÿæ¸¬å™¨ä½”ç”¨ï¼', 'warning');
                return;
            }
            
            // æ›´æ–°æ„Ÿæ¸¬å™¨ä½ç½®
            const sensor = sensors[sensorIndex];
            const oldX = sensor.x;
            const oldY = sensor.y;
            
            sensor.x = newX;
            sensor.y = newY;
            
            // æ›´æ–°UI
            const oldCell = document.querySelector(`.grid-cell[data-x="${oldX}"][data-y="${oldY}"]`);
            const newCell = document.querySelector(`.grid-cell[data-x="${newX}"][data-y="${newY}"]`);
            
            if (oldCell && newCell) {
                oldCell.classList.remove('occupied');
                oldCell.innerHTML = '';
                
                newCell.classList.add('occupied');
                const sensorElement = createSensorElement(sensor);
                newCell.appendChild(sensorElement);
            }
            
            showNotification(`å·²ç§»å‹• ${sensor.name} åˆ°ä½ç½® (${newX}, ${newY})`, 'info');
        }
        
        // åˆªé™¤æ„Ÿæ¸¬å™¨
        function deleteSensor(sensorId) {
            const sensorIndex = sensors.findIndex(s => s.id === sensorId);
            if (sensorIndex === -1) return;
            
            const sensor = sensors[sensorIndex];
            
            // å¾é™£åˆ—ä¸­ç§»é™¤
            sensors.splice(sensorIndex, 1);
            
            // æ›´æ–°UI
            const cell = document.querySelector(`.grid-cell[data-x="${sensor.x}"][data-y="${sensor.y}"]`);
            if (cell) {
                cell.classList.remove('occupied');
                cell.innerHTML = '';
            }
            
            // æ·»åŠ ç§»é™¤è­¦å ±
            addAlert({
                type: 'info',
                title: `${sensor.name} å·²ç§»é™¤`,
                message: 'æ„Ÿæ¸¬å™¨å·²å¾ç³»çµ±ä¸­ç§»é™¤',
                sensorId: sensorId,
                resolved: true
            });
            
            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            updateStats();
            
            // æ›´æ–°æŒ‘æˆ°é€²åº¦
            updateChallenges();
            
            // æ›´æ–°æ•¸æ“šé é¢
            if (currentPage === 'data') {
                updateDistributionChart();
                updatePerformanceMetrics();
            }
            
            // æ›´æ–°å„ªåŒ–é é¢
            if (currentPage === 'optimization') {
                updateOptimizationPage();
                updateOptimizationTips();
            }
            
            showNotification(`å·²ç§»é™¤ ${sensor.name}`, 'info');
        }
        
        // æ·»åŠ è­¦å ±
        function addAlert(alertData) {
            const newAlert = {
                id: systemAlerts.length > 0 ? Math.max(...systemAlerts.map(a => a.id)) + 1 : 1,
                type: alertData.type,
                title: alertData.title,
                message: alertData.message,
                timestamp: new Date(),
                sensorId: alertData.sensorId,
                resolved: alertData.resolved || false
            };
            
            systemAlerts.unshift(newAlert);
            
            // ä¿æŒæœ€å¤š10å€‹è­¦å ±
            if (systemAlerts.length > 10) {
                systemAlerts.pop();
            }
            
            updateAlertsDisplay();
            
            // å¦‚æœä¸åœ¨å„ªåŒ–é é¢ï¼Œé¡¯ç¤ºé€šçŸ¥
            if (currentPage !== 'optimization') {
                showNotification(`æ–°è­¦å ±: ${alertData.title}`, alertData.type);
            }
        }
        
        // æ›´æ–°è­¦å ±é¡¯ç¤º
        function updateAlertsDisplay() {
            const alertList = document.getElementById('alert-list');
            if (!alertList) return;
            
            alertList.innerHTML = '';
            
            const activeAlerts = systemAlerts.filter(alert => !alert.resolved).slice(0, 3);
            
            if (activeAlerts.length === 0) {
                alertList.innerHTML = '<div class="alert info"><i class="fas fa-check-circle"></i><div><h4>æ‰€æœ‰ç³»çµ±æ­£å¸¸</h4><p>æ²’æœ‰å¾…è™•ç†çš„è­¦å ±</p></div></div>';
                return;
            }
            
            activeAlerts.forEach(alert => {
                const alertElement = document.createElement('div');
                alertElement.className = `alert ${alert.type}`;
                alertElement.innerHTML = `
                    <i class="fas ${getAlertIcon(alert.type)}"></i>
                    <div>
                        <h4>${alert.title}</h4>
                        <p>${alert.message} - ${formatTime(alert.timestamp)}</p>
                    </div>
                `;
                
                alertElement.addEventListener('click', function() {
                    if (alert.sensorId) {
                        showSensorDetail(alert.sensorId);
                    }
                });
                
                alertList.appendChild(alertElement);
            });
        }
        
        // è¨ˆç®—ç³»çµ±è² è¼‰
        function calculateSystemLoad() {
            const sensorCount = sensors.length;
            const totalEnergyConsumption = sensors.reduce((sum, sensor) => sum + sensor.energy, 0);
            const budgetUsage = (usedBudget / totalBudget) * 100;
            
            // ç¶œåˆè¨ˆç®—ç³»çµ±è² è¼‰
            let load = 0;
            load += (sensorCount / 20) * 30; // æ„Ÿæ¸¬å™¨æ•¸é‡ä½”30%
            load += (totalEnergyConsumption / 5) * 30; // èƒ½æºæ¶ˆè€—ä½”30%
            load += (budgetUsage / 100) * 40; // é ç®—ä½¿ç”¨ä½”40%
            
            return Math.min(Math.round(load), 100);
        }
        
        // åˆå§‹åŒ–åœ–è¡¨
        function initializeCharts() {
            // æ„Ÿæ¸¬å™¨æ•¸æ“šåœ–è¡¨
            updateSensorChart();
            
            // èƒ½æºæ¶ˆè€—åœ–è¡¨
            updateEnergyChart();
            
            // èƒ½æºåœ–è¡¨æŒ‰éˆ•äº‹ä»¶
            document.getElementById('energy-day').addEventListener('click', function() {
                setActiveEnergyButton('day');
                updateEnergyChart('day');
            });
            
            document.getElementById('energy-week').addEventListener('click', function() {
                setActiveEnergyButton('week');
                updateEnergyChart('week');
            });
            
            document.getElementById('energy-month').addEventListener('click', function() {
                setActiveEnergyButton('month');
                updateEnergyChart('month');
            });
        }
        
        // æ›´æ–°æ„Ÿæ¸¬å™¨æ•¸æ“šåœ–è¡¨
        function updateSensorChart() {
            const sensorChart = document.getElementById('sensor-chart');
            if (!sensorChart) return;
            
            sensorChart.innerHTML = '';
            
            // æ ¹æ“šæ„Ÿæ¸¬å™¨é¡å‹åˆ†çµ„
            const sensorData = [
                {type: 'temperature', label: 'æº«åº¦', value: 0, color: '#ff6b6b'},
                {type: 'traffic', label: 'äº¤é€š', value: 0, color: '#4ecdc4'},
                {type: 'energy', label: 'èƒ½æº', value: 0, color: '#ffe66d'},
                {type: 'security', label: 'å®‰å…¨', value: 0, color: '#9d4edd'},
                {type: 'water', label: 'æ°´è³ª', value: 0, color: '#4361ee'},
                {type: 'air', label: 'ç©ºæ°£', value: 0, color: '#2a9d8f'},
                {type: 'waste', label: 'å»¢ç‰©', value: 0, color: '#f77f00'}
            ];
            
            // è¨ˆç®—æ¯å€‹é¡å‹çš„å¹³å‡æ•¸æ“šè³ªé‡
            sensorData.forEach(item => {
                const typeSensors = sensors.filter(s => s.type === item.type);
                if (typeSensors.length > 0) {
                    // åŸºæ–¼æ„Ÿæ¸¬å™¨ç‹€æ…‹ã€é›»é‡å’Œä¿¡è™Ÿè¨ˆç®—æ•¸æ“šè³ªé‡
                    const avgBattery = typeSensors.reduce((sum, s) => sum + s.battery, 0) / typeSensors.length;
                    const avgSignal = typeSensors.reduce((sum, s) => sum + s.signal, 0) / typeSensors.length;
                    const activeCount = typeSensors.filter(s => s.status === 'active').length;
                    
                    item.value = Math.round((avgBattery * 0.3 + avgSignal * 0.3 + (activeCount / typeSensors.length) * 40));
                } else {
                    item.value = Math.floor(Math.random() * 30) + 50; // éš¨æ©Ÿæ•¸æ“š
                }
            });
            
            const maxValue = Math.max(...sensorData.map(item => item.value));
            
            sensorData.forEach(item => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                const height = maxValue > 0 ? (item.value / maxValue) * 90 : 50;
                bar.style.height = `${height}%`;
                bar.style.background = `linear-gradient(to top, ${item.color}, ${item.color}99)`;
                
                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = item.label;
                
                const value = document.createElement('div');
                value.className = 'bar-value';
                value.textContent = item.value;
                
                bar.appendChild(value);
                bar.appendChild(label);
                sensorChart.appendChild(bar);
            });
        }
        
        // æ›´æ–°èƒ½æºåœ–è¡¨
        function updateEnergyChart(period = 'month') {
            const energyChart = document.getElementById('energy-chart');
            if (!energyChart) return;
            
            energyChart.innerHTML = '';
            
            let energyData, labels;
            const currentEnergy = sensors.reduce((sum, sensor) => sum + sensor.energy, 0);
            
            switch(period) {
                case 'day':
                    // æ¨¡æ“¬24å°æ™‚æ•¸æ“š
                    energyData = Array.from({length: 12}, (_, i) => {
                        const hour = i * 2;
                        let multiplier = 1;
                        if (hour >= 8 && hour <= 18) multiplier = 1.2; // æ—¥é–“é«˜å³°
                        if (hour >= 20 || hour <= 6) multiplier = 0.8; // å¤œé–“ä½è°·
                        return parseFloat((currentEnergy * multiplier + (Math.random() - 0.5) * 0.3).toFixed(2));
                    });
                    labels = Array.from({length: 12}, (_, i) => `${i*2}:00`);
                    break;
                    
                case 'week':
                    // æ¨¡æ“¬ä¸€é€±æ•¸æ“š
                    energyData = ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'æ—¥'].map((day, i) => {
                        let multiplier = 1;
                        if (i >= 0 && i <= 4) multiplier = 1.1; // å·¥ä½œæ—¥
                        if (i === 5) multiplier = 0.9; // é€±å…­
                        if (i === 6) multiplier = 0.8; // é€±æ—¥
                        return parseFloat((currentEnergy * multiplier + (Math.random() - 0.5) * 0.2).toFixed(2));
                    });
                    labels = ['é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­', 'é€±æ—¥'];
                    break;
                    
                case 'month':
                default:
                    // æ¨¡æ“¬4é€±æ•¸æ“š
                    energyData = Array.from({length: 12}, (_, i) => {
                        const week = i + 1;
                        let multiplier = 1;
                        if (week === 2 || week === 4) multiplier = 0.95;
                        return parseFloat((currentEnergy * multiplier + (Math.random() - 0.5) * 0.15).toFixed(2));
                    });
                    labels = Array.from({length: 12}, (_, i) => `ç¬¬${i+1}é€±`);
                    break;
            }
            
            const maxEnergy = Math.max(...energyData);
            const minHeight = 20; // æœ€å°é«˜åº¦ç™¾åˆ†æ¯”
            
            energyData.forEach((value, index) => {
                const bar = document.createElement('div');
                bar.className = 'bar';
                const height = maxEnergy > 0 ? Math.max((value / maxEnergy) * 80, minHeight) : minHeight;
                bar.style.height = `${height}%`;
                
                const label = document.createElement('div');
                label.className = 'bar-label';
                label.textContent = labels[index];
                
                const valueEl = document.createElement('div');
                valueEl.className = 'bar-value';
                valueEl.textContent = value.toFixed(1);
                
                bar.appendChild(valueEl);
                bar.appendChild(label);
                energyChart.appendChild(bar);
            });
        }
        
        // è¨­ç½®èƒ½æºåœ–è¡¨æŒ‰éˆ•ç‹€æ…‹
        function setActiveEnergyButton(period) {
            document.querySelectorAll('#energy-day, #energy-week, #energy-month').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`energy-${period}`).classList.add('active');
        }
        
        // æ›´æ–°æ„Ÿæ¸¬å™¨åˆ†ä½ˆåœ–è¡¨
        function updateDistributionChart() {
            // è¨ˆç®—æ¯ç¨®é¡å‹çš„æ„Ÿæ¸¬å™¨æ•¸é‡
            const typeCounts = {
                temperature: sensors.filter(s => s.type === 'temperature').length,
                traffic: sensors.filter(s => s.type === 'traffic').length,
                energy: sensors.filter(s => s.type === 'energy').length,
                security: sensors.filter(s => s.type === 'security').length,
                water: sensors.filter(s => s.type === 'water').length,
                air: sensors.filter(s => s.type === 'air').length,
                waste: sensors.filter(s => s.type === 'waste').length
            };
            
            const totalSensors = sensors.length;
            
            // æ›´æ–°é¡¯ç¤º
            const elements = {
                temperature: {value: 'temp-count', bar: 'temp-bar'},
                traffic: {value: 'traffic-count', bar: 'traffic-bar'},
                energy: {value: 'energy-count', bar: 'energy-bar'},
                security: {value: 'security-count', bar: 'security-bar'}
            };
            
            Object.keys(elements).forEach(type => {
                const element = elements[type];
                const valueElement = document.getElementById(element.value);
                const barElement = document.getElementById(element.bar);
                
                if (valueElement && barElement) {
                    valueElement.textContent = typeCounts[type];
                    const percentage = totalSensors > 0 ? (typeCounts[type] / totalSensors) * 100 : 0;
                    barElement.style.width = `${percentage}%`;
                }
            });
        }
        
        // æ›´æ–°æ•ˆèƒ½æŒ‡æ¨™
        function updatePerformanceMetrics() {
            const sensorCount = sensors.length;
            
            // è¨ˆç®—å›æ‡‰æ™‚é–“ï¼ˆåŸºæ–¼æ„Ÿæ¸¬å™¨æ•¸é‡å’Œç‹€æ…‹ï¼‰
            let responseTime = 100 + (sensorCount * 5);
            sensors.forEach(sensor => {
                if (sensor.status !== 'active') responseTime += 20;
                if (sensor.signal < 80) responseTime += 15;
            });
            responseTime = Math.min(responseTime, 500);
            
            // è¨ˆç®—æ•¸æ“šæº–ç¢ºç‡ï¼ˆåŸºæ–¼æ„Ÿæ¸¬å™¨ç‹€æ…‹ï¼‰
            let accuracy = 95;
            sensors.forEach(sensor => {
                if (sensor.status !== 'active') accuracy -= 2;
                if (sensor.battery < 50) accuracy -= 1;
                if (sensor.signal < 80) accuracy -= 1.5;
            });
            accuracy = Math.max(accuracy, 70);
            
            // è¨ˆç®—ç³»çµ±å¯ç”¨æ€§
            let availability = 99.5;
            const warningSensors = sensors.filter(s => s.status === 'warning').length;
            const inactiveSensors = sensors.filter(s => s.status === 'inactive').length;
            availability -= (warningSensors * 0.2 + inactiveSensors * 0.5);
            availability = Math.max(availability, 95);
            
            // æ›´æ–°é¡¯ç¤º
            document.getElementById('response-time').textContent = `${Math.round(responseTime)}ms`;
            document.getElementById('accuracy-rate').textContent = `${accuracy.toFixed(1)}%`;
            document.getElementById('availability-rate').textContent = `${availability.toFixed(1)}%`;
            
            document.getElementById('response-bar').style.width = `${100 - (responseTime / 5)}%`;
            document.getElementById('accuracy-bar').style.width = `${accuracy}%`;
            document.getElementById('availability-bar').style.width = `${availability}%`;
        }
        
        // æ›´æ–°å„ªåŒ–é é¢æ•¸æ“š
        function updateOptimizationPage() {
            // è¨ˆç®—æˆæœ¬
            const sensorCost = sensors.reduce((sum, sensor) => sum + sensor.cost, 0);
            const maintenanceCost = sensorCost * 0.25;
            const energyCost = sensors.reduce((sum, sensor) => sum + sensor.energy, 0) * 50; // å‡è¨­$50/kW
            const totalCost = sensorCost + maintenanceCost + energyCost;
            
            // æ›´æ–°æˆæœ¬é¡¯ç¤º
            document.getElementById('sensor-cost').textContent = `$${sensorCost.toLocaleString()}`;
            document.getElementById('maintenance-cost').textContent = `$${Math.round(maintenanceCost).toLocaleString()}`;
            document.getElementById('energy-cost').textContent = `$${Math.round(energyCost).toLocaleString()}`;
            document.getElementById('total-cost').textContent = `$${Math.round(totalCost).toLocaleString()}`;
            
            // è¨ˆç®—é ç®—å¥åº·åº¦
            const budgetUsage = (totalCost / totalBudget) * 100;
            let budgetHealth = 'è‰¯å¥½';
            let budgetHealthClass = 'good';
            if (budgetUsage > 80) {
                budgetHealth = 'å±éšª';
                budgetHealthClass = 'danger';
            } else if (budgetUsage > 60) {
                budgetHealth = 'è­¦å‘Š';
                budgetHealthClass = 'warning';
            }
            
            document.getElementById('budget-health').textContent = budgetHealth;
            document.getElementById('budget-health-bar').className = `progress-fill ${budgetHealthClass}`;
            document.getElementById('budget-health-bar').style.width = `${100 - budgetUsage}%`;
            
            // æ›´æ–°èƒ½æºæ•¸æ“š
            const currentEnergy = sensors.reduce((sum, sensor) => sum + sensor.energy, 0);
            const targetEnergy = Math.max(currentEnergy * 0.9, 1.5);
            const savingPotential = ((currentEnergy - targetEnergy) / currentEnergy) * 100;
            const energyEfficiency = (targetEnergy / currentEnergy) * 100;
            
            document.getElementById('current-energy').textContent = `${currentEnergy.toFixed(1)} kW`;
            document.getElementById('target-energy').textContent = `${targetEnergy.toFixed(1)} kW`;
            document.getElementById('saving-potential').textContent = `${savingPotential.toFixed(1)}%`;
            document.getElementById('energy-efficiency').textContent = `${energyEfficiency.toFixed(1)}%`;
            document.getElementById('energy-efficiency-bar').style.width = `${energyEfficiency}%`;
            
            // æ›´æ–°æ•ˆèƒ½é æ¸¬
            const currentPerformance = calculateSystemPerformance();
            const predictedPerformance = Math.min(currentPerformance + 7, 100);
            
            document.getElementById('current-performance').textContent = `${currentPerformance}%`;
            document.getElementById('predicted-performance').textContent = `${predictedPerformance}%`;
            document.getElementById('current-performance-bar').style.width = `${currentPerformance}%`;
            document.getElementById('predicted-performance-bar').style.width = `${predictedPerformance}%`;
            
            const optimizationPotential = predictedPerformance - currentPerformance;
            document.getElementById('optimization-potential').textContent = `${optimizationPotential}%`;
            document.getElementById('optimization-potential-bar').style.width = `${optimizationPotential * 10}%`;
            
            // æ›´æ–°é ç®—æ¢
            document.getElementById('optimization-budget-fill').style.width = `${budgetUsage}%`;
            
            // æ›´æ–°ç¸½é ç®—é¡¯ç¤º
            document.getElementById('total-budget').textContent = totalBudget.toLocaleString();
        }
        
        // æ›´æ–°å„ªåŒ–å»ºè­°
        function updateOptimizationTips() {
            const tipsList = document.getElementById('optimization-tips-list');
            const predictionList = document.getElementById('prediction-details-list');
            
            if (!tipsList || !predictionList) return;
            
            tipsList.innerHTML = '';
            predictionList.innerHTML = '';
            
            const currentEnergy = sensors.reduce((sum, sensor) => sum + sensor.energy, 0);
            const sensorCount = sensors.length;
            const budgetUsage = (usedBudget / totalBudget) * 100;
            
            // ç”Ÿæˆå„ªåŒ–å»ºè­°
            const tips = [];
            const predictions = [];
            
            if (currentEnergy > 3) {
                tips.push('<li>å•Ÿç”¨æ‰€æœ‰æ„Ÿæ¸¬å™¨çš„ç¯€èƒ½æ¨¡å¼</li>');
                predictions.push('<li>èƒ½æºæ¶ˆè€—é™ä½ 15-20%</li>');
            }
            
            if (sensorCount > 10) {
                tips.push('<li>åˆä½µç›¸é„°çš„æº«åº¦æ„Ÿæ¸¬å™¨</li>');
                predictions.push('<li>ç¶­è­·æˆæœ¬æ¸›å°‘ 10%</li>');
            }
            
            if (budgetUsage > 70) {
                tips.push('<li>æš«åœéé—œéµæ„Ÿæ¸¬å™¨çš„æ•¸æ“šå‚³è¼¸</li>');
                predictions.push('<li>é ç®—ä½¿ç”¨é™ä½ 15%</li>');
            }
            
            const lowBatterySensors = sensors.filter(s => s.battery < 50);
            if (lowBatterySensors.length > 0) {
                tips.push(`<li>ç‚º ${lowBatterySensors.length} å€‹ä½é›»é‡æ„Ÿæ¸¬å™¨å……é›»</li>`);
                predictions.push('<li>ç³»çµ±ç©©å®šæ€§æé«˜ 8%</li>');
            }
            
            const lowSignalSensors = sensors.filter(s => s.signal < 70);
            if (lowSignalSensors.length > 0) {
                tips.push(`<li>æª¢æŸ¥ ${lowSignalSensors.length} å€‹ä½ä¿¡è™Ÿæ„Ÿæ¸¬å™¨çš„ç¶²çµ¡é€£æ¥</li>`);
                predictions.push('<li>æ•¸æ“šæº–ç¢ºç‡æé«˜ 12%</li>');
            }
            
            if (tips.length === 0) {
                tips.push('<li>ç³»çµ±å·²å„ªåŒ–è‰¯å¥½ï¼Œä¿æŒç•¶å‰é…ç½®</li>');
                predictions.push('<li>ç¹¼çºŒç›£æ§ç³»çµ±ç‹€æ…‹</li>');
            }
            
            tipsList.innerHTML = tips.join('');
            predictionList.innerHTML = predictions.join('');
        }
        
        // è¨ˆç®—ç³»çµ±æ•ˆèƒ½
        function calculateSystemPerformance() {
            let performance = 85; // åŸºç¤æ•ˆèƒ½
            
            // åŸºæ–¼æ„Ÿæ¸¬å™¨ç‹€æ…‹èª¿æ•´
            const activeSensors = sensors.filter(s => s.status === 'active').length;
            const totalSensors = sensors.length;
            const activeRatio = totalSensors > 0 ? activeSensors / totalSensors : 1;
            performance += (activeRatio * 10) - 5;
            
            // åŸºæ–¼é›»é‡èª¿æ•´
            const avgBattery = sensors.length > 0 ? 
                sensors.reduce((sum, s) => sum + s.battery, 0) / sensors.length : 100;
            performance += (avgBattery / 100) * 5;
            
            // åŸºæ–¼é ç®—ä½¿ç”¨èª¿æ•´
            const budgetUsage = (usedBudget / totalBudget) * 100;
            if (budgetUsage > 90) performance -= 15;
            else if (budgetUsage > 70) performance -= 8;
            else if (budgetUsage < 30) performance += 5;
            
            // åŸºæ–¼èƒ½æºæ•ˆç‡èª¿æ•´
            const currentEnergy = sensors.reduce((sum, sensor) => sum + sensor.energy, 0);
            const optimalEnergy = sensors.length * 0.4; // å‡è¨­æ¯å€‹æ„Ÿæ¸¬å™¨æœ€ä½³èƒ½è€—0.4kW
            const energyEfficiency = optimalEnergy > 0 ? (optimalEnergy / currentEnergy) * 100 : 100;
            performance += (energyEfficiency - 100) / 10;
            
            return Math.max(60, Math.min(100, Math.round(performance)));
        }
        
        // æ›´æ–°çµ±è¨ˆæ•¸æ“š
        function updateStats() {
            // è¨ˆç®—çµ±è¨ˆæ•¸æ“š
            const sensorCount = sensors.length;
            
            // è¨ˆç®—ç¸½æˆæœ¬å’Œèƒ½æºæ¶ˆè€—
            let totalSensorCost = 0;
            let totalEnergy = 0;
            
            sensors.forEach(sensor => {
                totalSensorCost += sensor.cost;
                totalEnergy += sensor.energy;
            });
            
            // è¨ˆç®—ç¶­è­·æˆæœ¬ï¼ˆæ„Ÿæ¸¬å™¨æˆæœ¬çš„25%ï¼‰
            const maintenanceCost = totalSensorCost * 0.25;
            usedBudget = totalSensorCost + maintenanceCost;
            
            // è¨ˆç®—é ç®—ä½¿ç”¨ç‡
            const budgetUsage = totalBudget > 0 ? (usedBudget / totalBudget) * 100 : 0;
            
            // è¨ˆç®—ç³»çµ±æ•ˆèƒ½å’Œè² è¼‰
            const efficiency = calculateSystemPerformance();
            const systemLoad = calculateSystemLoad();
            
            // æ›´æ–°UI
            document.getElementById('sensor-count').textContent = sensorCount;
            document.getElementById('system-efficiency').textContent = `${efficiency}%`;
            document.getElementById('budget-usage').textContent = `${Math.round(budgetUsage)}%`;
            document.getElementById('energy-consumption').textContent = `${totalEnergy.toFixed(1)}kW`;
            document.getElementById('system-load').textContent = `${systemLoad}%`;
            
            // æ›´æ–°é ç®—æ¢
            document.getElementById('budget-fill').style.width = `${budgetUsage}%`;
            document.getElementById('budget-used').textContent = `$${Math.round(usedBudget)}`;
            
            // æ›´æ–°ç³»çµ±è² è¼‰æ¢é¡è‰²
            const systemLoadBar = document.getElementById('system-load-bar');
            systemLoadBar.style.width = `${systemLoad}%`;
            if (systemLoad > 80) {
                systemLoadBar.className = 'progress-fill danger';
            } else if (systemLoad > 60) {
                systemLoadBar.className = 'progress-fill warning';
            } else {
                systemLoadBar.className = 'progress-fill good';
            }
            
            // éš¨æ©Ÿæ›´æ–°æ„Ÿæ¸¬å™¨ç‹€æ…‹ï¼ˆæ¨¡æ“¬çœŸå¯¦ç’°å¢ƒï¼‰
            sensors.forEach(sensor => {
                // é›»é‡è‡ªç„¶æ¶ˆè€—
                if (Math.random() > 0.7) {
                    sensor.battery = Math.max(0, sensor.battery - Math.random() * 3);
                    if (sensor.battery < 20 && sensor.status === 'active') {
                        sensor.status = 'warning';
                        addAlert({
                            type: 'warning',
                            title: `${sensor.name} é›»é‡ä½`,
                            message: `é›»é‡åƒ…å‰© ${sensor.battery.toFixed(0)}%ï¼Œè«‹å……é›»`,
                            sensorId: sensor.id,
                            resolved: false
                        });
                    }
                }
                
                // ä¿¡è™Ÿå¼·åº¦æ³¢å‹•
                if (Math.random() > 0.8) {
                    const change = (Math.random() - 0.5) * 10;
                    sensor.signal = Math.max(30, Math.min(100, sensor.signal + change));
                    
                    if (sensor.signal < 60 && sensor.status === 'active') {
                        sensor.status = 'warning';
                        addAlert({
                            type: 'warning',
                            title: `${sensor.name} ä¿¡è™Ÿå¼±`,
                            message: `ä¿¡è™Ÿå¼·åº¦ ${sensor.signal.toFixed(0)}%ï¼Œå¯èƒ½å½±éŸ¿æ•¸æ“šå‚³è¼¸`,
                            sensorId: sensor.id,
                            resolved: false
                        });
                    }
                }
                
                // æ›´æ–°æœ€å¾Œæ›´æ–°æ™‚é–“
                if (Math.random() > 0.5) {
                    sensor.lastUpdate = new Date();
                }
            });
            
            // æ›´æ–°å…¶ä»–é é¢
            if (currentPage === 'data') {
                updateSensorChart();
                updatePerformanceMetrics();
                updateDistributionChart();
            }
            
            if (currentPage === 'optimization') {
                updateOptimizationPage();
                updateOptimizationTips();
            }
        }
        
        // ç²å–æ„Ÿæ¸¬å™¨åœ–æ¨™
        function getSensorIcon(type) {
            switch(type) {
                case 'temperature': return 'fas fa-thermometer-half';
                case 'traffic': return 'fas fa-traffic-light';
                case 'energy': return 'fas fa-bolt';
                case 'security': return 'fas fa-shield-alt';
                case 'water': return 'fas fa-tint';
                case 'air': return 'fas fa-wind';
                case 'waste': return 'fas fa-trash-alt';
                default: return 'fas fa-microchip';
            }
        }
        
        // ç²å–æ„Ÿæ¸¬å™¨åç¨±
        function getSensorName(type) {
            switch(type) {
                case 'temperature': return 'æº«åº¦æ„Ÿæ¸¬å™¨';
                case 'traffic': return 'äº¤é€šæ„Ÿæ¸¬å™¨';
                case 'energy': return 'èƒ½æºæ„Ÿæ¸¬å™¨';
                case 'security': return 'å®‰å…¨ç›£æ§';
                case 'water': return 'æ°´è³ªç›£æ¸¬';
                case 'air': return 'ç©ºæ°£å“è³ª';
                case 'waste': return 'å»¢ç‰©ç®¡ç†';
                default: return 'æ„Ÿæ¸¬å™¨';
            }
        }
        
        // ç²å–ç‹€æ…‹æ–‡å­—
        function getStatusText(status) {
            switch(status) {
                case 'active': return 'é‹ä½œä¸­';
                case 'warning': return 'è­¦å‘Š';
                case 'inactive': return 'é›¢ç·š';
                default: return 'æœªçŸ¥';
            }
        }
        
        // ç²å–ä½ç½®åç¨±
        function getLocationName(location) {
            switch(location) {
                case 'residential': return 'ä½å®…å€';
                case 'commercial': return 'å•†æ¥­å€';
                case 'industrial': return 'å·¥æ¥­å€';
                case 'park': return 'å…¬åœ’å€åŸŸ';
                case 'transportation': return 'äº¤é€šæ¨ç´';
                default: return 'æœªæŒ‡å®š';
            }
        }
        
        // ç²å–è­¦å ±åœ–æ¨™
        function getAlertIcon(type) {
            switch(type) {
                case 'warning': return 'fa-exclamation-triangle';
                case 'danger': return 'fa-exclamation-circle';
                case 'info': return 'fa-info-circle';
                default: return 'fa-bell';
            }
        }
        
        // æ ¼å¼åŒ–æ™‚é–“
        function formatTime(date) {
            if (!(date instanceof Date)) date = new Date(date);
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);
            
            if (diffMins < 1) return 'å‰›å‰›';
            if (diffMins < 60) return `${diffMins}åˆ†é˜å‰`;
            if (diffHours < 24) return `${diffHours}å°æ™‚å‰`;
            if (diffDays < 7) return `${diffDays}å¤©å‰`;
            return date.toLocaleDateString('zh-TW');
        }
        
        // ç‚ºæ„Ÿæ¸¬å™¨åˆ—è¡¨é …ç›®æ·»åŠ æ‹–å‹•åŠŸèƒ½
        document.querySelectorAll('.sensor-item').forEach(item => {
            item.setAttribute('draggable', 'true');
            
            item.addEventListener('dragstart', function(e) {
                const type = this.dataset.type;
                const cost = this.dataset.cost;
                const energy = this.dataset.energy;
                
                e.dataTransfer.setData('sensorType', type);
                e.dataTransfer.setData('sensorCost', cost);
                e.dataTransfer.setData('sensorEnergy', energy);
            });
        });
        
        // é¡¯ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            // æª¢æŸ¥æ˜¯å¦å·²æœ‰ç›¸åŒé€šçŸ¥
            const existingNotifications = document.querySelectorAll('.notification');
            if (existingNotifications.length > 3) {
                existingNotifications[0].remove();
            }
            
            // å‰µå»ºé€šçŸ¥å…ƒç´ 
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            const messageSpan = document.createElement('span');
            messageSpan.textContent = message;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'notification-close';
            closeBtn.innerHTML = '&times;';
            closeBtn.addEventListener('click', function() {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
            
            notification.appendChild(messageSpan);
            notification.appendChild(closeBtn);
            
            document.body.appendChild(notification);
            
            // é¡¯ç¤ºé€šçŸ¥
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            // 5ç§’å¾Œè‡ªå‹•ç§»é™¤é€šçŸ¥
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.transform = 'translateX(100%)';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, 300);
                }
            }, 5000);
        }
        
        // äº‹ä»¶ç›£è½å™¨
        document.getElementById('start-simulation').addEventListener('click', function() {
            document.querySelector('[data-page="city"]').click();
            showNotification('æ­¡è¿ä½¿ç”¨æ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨ï¼é–‹å§‹éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€å€‹æ„Ÿæ¸¬å™¨å§ã€‚', 'success');
        });
        
        document.getElementById('reset-city').addEventListener('click', function() {
            if (confirm('ç¢ºå®šè¦é‡ç½®åŸå¸‚å—ï¼Ÿæ‰€æœ‰æ„Ÿæ¸¬å™¨å°‡è¢«ç§»é™¤ï¼Œé ç®—é‡ç½®ç‚º$3,000ã€‚')) {
                sensors = [];
                totalBudget = 3000;
                usedBudget = 0;
                totalEnergy = 0;
                systemAlerts = [];
                optimizationHistory = [];
                challenges = {
                    cityPlanner: {completed: false, progress: 0, total: 5, rewarded: false},
                    energyExpert: {completed: false, progress: 0, target: 2.0, rewarded: false},
                    sensorMaster: {completed: false, progress: 0, total: 5, rewarded: false}
                };
                initializeCityGrid();
                updateStats();
                updateChallenges();
                updateAlertsDisplay();
                showNotification('åŸå¸‚å·²é‡ç½®ï¼æ‚¨å¯ä»¥é‡æ–°é–‹å§‹éƒ¨ç½²æ„Ÿæ¸¬å™¨ã€‚', 'info');
            }
        });
        
        document.getElementById('add-sensor-btn').addEventListener('click', function() {
            sensorModal.classList.add('active');
        });
        
        closeModalBtn.addEventListener('click', function() {
            sensorModal.classList.remove('active');
        });
        
        closeDetailModalBtn.addEventListener('click', function() {
            sensorDetailModal.classList.remove('active');
        });
        
        cancelSensorBtn.addEventListener('click', function() {
            sensorModal.classList.remove('active');
        });
        
        // æ„Ÿæ¸¬å™¨é¡å‹é¸æ“‡æ™‚æ›´æ–°é è¦½
        sensorTypeSelect.addEventListener('change', function() {
            const type = this.value;
            if (!type) return;
            
            let cost = 120;
            let energy = 0.3;
            
            switch(type) {
                case 'temperature':
                    cost = 120;
                    energy = 0.3;
                    break;
                case 'traffic':
                    cost = 200;
                    energy = 0.5;
                    break;
                case 'energy':
                    cost = 180;
                    energy = 0.4;
                    break;
                case 'security':
                    cost = 250;
                    energy = 0.6;
                    break;
                case 'water':
                    cost = 220;
                    energy = 0.4;
                    break;
                case 'air':
                    cost = 190;
                    energy = 0.35;
                    break;
                case 'waste':
                    cost = 170;
                    energy = 0.3;
                    break;
            }
            
            const config = document.getElementById('sensor-config');
            const dataRate = config ? parseInt(config.value) : 30;
            const costMultiplier = dataRate / 30;
            const energyMultiplier = dataRate / 30;
            
            const finalCost = Math.round(cost * costMultiplier);
            const finalEnergy = parseFloat((energy * energyMultiplier).toFixed(2));
            
            costPreview.textContent = `$${finalCost}`;
            energyPreview.textContent = `${finalEnergy}kW`;
        });
        
        // å–æ¨£ç‡é¸æ“‡æ™‚æ›´æ–°é è¦½
        document.getElementById('sensor-config').addEventListener('change', function() {
            const type = sensorTypeSelect.value;
            if (!type) return;
            
            let cost = 120;
            let energy = 0.3;
            
            switch(type) {
                case 'temperature':
                    cost = 120;
                    energy = 0.3;
                    break;
                case 'traffic':
                    cost = 200;
                    energy = 0.5;
                    break;
                case 'energy':
                    cost = 180;
                    energy = 0.4;
                    break;
                case 'security':
                    cost = 250;
                    energy = 0.6;
                    break;
                case 'water':
                    cost = 220;
                    energy = 0.4;
                    break;
                case 'air':
                    cost = 190;
                    energy = 0.35;
                    break;
                case 'waste':
                    cost = 170;
                    energy = 0.3;
                    break;
            }
            
            const dataRate = parseInt(this.value);
            const costMultiplier = dataRate / 30;
            const energyMultiplier = dataRate / 30;
            
            const finalCost = Math.round(cost * costMultiplier);
            const finalEnergy = parseFloat((energy * energyMultiplier).toFixed(2));
            
            costPreview.textContent = `$${finalCost}`;
            energyPreview.textContent = `${finalEnergy}kW`;
        });
        
        sensorForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = sensorTypeSelect.value;
            if (!type) {
                showNotification('è«‹é¸æ“‡æ„Ÿæ¸¬å™¨é¡å‹', 'warning');
                return;
            }
            
            // å°‹æ‰¾ç©ºé–’ä½ç½®
            let placed = false;
            const cells = document.querySelectorAll('.grid-cell:not(.occupied)');
            if (cells.length > 0) {
                const randomCell = cells[Math.floor(Math.random() * cells.length)];
                const x = parseInt(randomCell.dataset.x);
                const y = parseInt(randomCell.dataset.y);
                
                const success = addNewSensor(type, 0, 0, x, y);
                
                if (success) {
                    // é—œé–‰æ¨¡æ…‹æ¡†
                    sensorModal.classList.remove('active');
                    
                    // é‡ç½®è¡¨å–®
                    this.reset();
                    
                    // é‡ç½®é è¦½
                    costPreview.textContent = '$120';
                    energyPreview.textContent = '0.3kW';
                }
            } else {
                showNotification('åŸå¸‚åœ°åœ–å·²æ»¿ï¼è«‹å…ˆåˆªé™¤ä¸€äº›æ„Ÿæ¸¬å™¨ã€‚', 'warning');
            }
        });
        
        document.getElementById('refresh-data').addEventListener('click', function() {
            // æ¨¡æ“¬æ•¸æ“šåˆ·æ–°
            const btn = this;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="loading"></span> åˆ·æ–°ä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                updateSensorChart();
                updateEnergyChart();
                updatePerformanceMetrics();
                updateDistributionChart();
                
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                showNotification('æ•¸æ“šå·²åˆ·æ–°ï¼', 'success');
            }, 1000);
        });
        
        document.getElementById('export-data').addEventListener('click', function() {
            const btn = this;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="loading"></span> å°å‡ºä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                // å‰µå»ºå¯å°å‡ºçš„æ•¸æ“š
                const exportData = {
                    sensors: sensors,
                    stats: {
                        totalBudget: totalBudget,
                        usedBudget: usedBudget,
                        totalEnergy: sensors.reduce((sum, s) => sum + s.energy, 0),
                        sensorCount: sensors.length,
                        efficiency: calculateSystemPerformance(),
                        load: calculateSystemLoad()
                    },
                    alerts: systemAlerts.filter(a => !a.resolved),
                    challenges: challenges,
                    gameMode: currentGameMode,
                    timestamp: new Date().toISOString(),
                    version: '2.0'
                };
                
                // å‰µå»ºJSONæ–‡ä»¶
                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                // å‰µå»ºä¸‹è¼‰é€£çµ
                const url = URL.createObjectURL(dataBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `æ™ºæ…§åŸå¸‚æ•¸æ“š_${new Date().toISOString().slice(0,10)}_${new Date().getHours()}${new Date().getMinutes()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                showNotification('æ•¸æ“šå·²å°å‡ºç‚ºJSONæ–‡ä»¶ï¼', 'success');
            }, 1500);
        });
        
        document.getElementById('run-optimization').addEventListener('click', function() {
            const btn = this;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span class="loading"></span> å„ªåŒ–ä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                // æ¨¡æ“¬å„ªåŒ–éç¨‹
                const originalPerformance = calculateSystemPerformance();
                
                // éš¨æ©Ÿæ‡‰ç”¨ä¸€äº›å„ªåŒ–
                let optimizations = 0;
                sensors.forEach(sensor => {
                    // éš¨æ©Ÿé™ä½ä¸€äº›æ„Ÿæ¸¬å™¨çš„å–æ¨£ç‡
                    if (Math.random() > 0.6 && sensor.dataRate > 10) {
                        const oldRate = sensor.dataRate;
                        sensor.dataRate = Math.max(10, sensor.dataRate - Math.floor(Math.random() * 20));
                        sensor.energy = sensor.energy * (sensor.dataRate / oldRate);
                        optimizations++;
                        
                        addAlert({
                            type: 'info',
                            title: `${sensor.name} å–æ¨£ç‡å„ªåŒ–`,
                            message: `å–æ¨£ç‡å¾ ${oldRate} èª¿æ•´ç‚º ${sensor.dataRate} æ¬¡/å°æ™‚`,
                            sensorId: sensor.id,
                            resolved: true
                        });
                    }
                    
                    // éš¨æ©Ÿä¿®å¾©ä¸€äº›è­¦å‘Šç‹€æ…‹
                    if (sensor.status === 'warning' && Math.random() > 0.7) {
                        sensor.status = 'active';
                        optimizations++;
                        
                        addAlert({
                            type: 'success',
                            title: `${sensor.name} ç‹€æ…‹æ¢å¾©`,
                            message: 'æ„Ÿæ¸¬å™¨ç‹€æ…‹å·²æ¢å¾©æ­£å¸¸',
                            sensorId: sensor.id,
                            resolved: true
                        });
                    }
                });
                
                // è¨˜éŒ„å„ªåŒ–æ­·å²
                const newPerformance = calculateSystemPerformance();
                const improvement = newPerformance - originalPerformance;
                
                optimizationHistory.push({
                    timestamp: new Date(),
                    originalPerformance: originalPerformance,
                    newPerformance: newPerformance,
                    improvement: improvement,
                    optimizations: optimizations
                });
                
                // ä¿æŒæœ€å¤š5æ¢æ­·å²è¨˜éŒ„
                if (optimizationHistory.length > 5) {
                    optimizationHistory.shift();
                }
                
                // æ›´æ–°æ‰€æœ‰é¡¯ç¤º
                updateStats();
                updateOptimizationPage();
                updateOptimizationTips();
                updateAlertsDisplay();
                
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                showNotification(`ç³»çµ±å„ªåŒ–å®Œæˆï¼åŸ·è¡Œäº† ${optimizations} é …å„ªåŒ–ï¼Œæ•ˆèƒ½å¾ ${originalPerformance}% æå‡è‡³ ${newPerformance}%`, 'success');
            }, 2000);
        });
        
        document.getElementById('add-budget').addEventListener('click', function() {
            const additionalBudget = 1000;
            totalBudget += additionalBudget;
            
            // è¨˜éŒ„é ç®—å¢åŠ 
            addAlert({
                type: 'info',
                title: 'é ç®—å¢åŠ ',
                message: `é ç®—å¢åŠ äº† $${additionalBudget.toLocaleString()}`,
                resolved: true
            });
            
            updateStats();
            showNotification(`é ç®—å·²å¢åŠ  $${additionalBudget.toLocaleString()}ï¼ç¸½é ç®—ç¾ç‚º $${totalBudget.toLocaleString()}`, 'success');
        });
        
        document.getElementById('view-all-alerts').addEventListener('click', function() {
            if (systemAlerts.length === 0) {
                showNotification('ç›®å‰æ²’æœ‰ç³»çµ±è­¦å ±', 'info');
                return;
            }
            
            let alertDetails = 'ç³»çµ±è­¦å ±è¨˜éŒ„ï¼š\n\n';
            systemAlerts.forEach((alert, index) => {
                alertDetails += `${index + 1}. [${alert.type.toUpperCase()}] ${alert.title}\n`;
                alertDetails += `    ${alert.message}\n`;
                alertDetails += `    ${formatTime(alert.timestamp)}\n`;
                alertDetails += `    ${alert.resolved ? 'âœ“ å·²è™•ç†' : 'â—‹ å¾…è™•ç†'}\n\n`;
            });
            
            alert(alertDetails);
        });
        
        // æ•¸æ“šé€±æœŸé¸æ“‡äº‹ä»¶
        document.getElementById('data-period').addEventListener('change', function() {
            const periodText = this.options[this.selectedIndex].text;
            showNotification(`å·²åˆ‡æ›åˆ°${periodText}æ•¸æ“šè¦–åœ–`, 'info');
            updateSensorChart();
        });
        
        // é»æ“Šæ¨¡æ…‹æ¡†å¤–éƒ¨é—œé–‰
        window.addEventListener('click', function(e) {
            if (e.target === sensorModal) {
                sensorModal.classList.remove('active');
            }
            if (e.target === sensorDetailModal) {
                sensorDetailModal.classList.remove('active');
            }
            if (e.target === guideModal) {
                guideModal.classList.remove('active');
            }
        });
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeCityGrid();
            initializeAlerts();
            updateStats();
            updateOptimizationPage();
            updateOptimizationTips();
            updateChallenges();
            
            // åˆå§‹åŒ–ç³»çµ±è­¦å ±
            systemAlerts = [
                {
                    id: 1,
                    type: 'warning',
                    title: 'å€åŸŸAèƒ½æºæ¶ˆè€—éé«˜',
                    message: 'å»ºè­°æª¢æŸ¥æº«åº¦æ„Ÿæ¸¬å™¨é…ç½®',
                    timestamp: new Date(Date.now() - 3600000),
                    sensorId: 1,
                    resolved: false
                },
                {
                    id: 2,
                    type: 'info',
                    title: 'äº¤é€šæ„Ÿæ¸¬å™¨éœ€è¦æ ¡æº–',
                    message: 'è¨ˆåŠƒç¶­è­·æ™‚é–“: æ˜å¤© 02:00-04:00',
                    timestamp: new Date(Date.now() - 7200000),
                    sensorId: 2,
                    resolved: false
                },
                {
                    id: 3,
                    type: 'danger',
                    title: 'å®‰å…¨ç›£æ§ç³»çµ±é›¢ç·š',
                    message: 'éœ€è¦ç«‹å³æª¢æŸ¥ç¶²çµ¡é€£æ¥',
                    timestamp: new Date(Date.now() - 1800000),
                    sensorId: 4,
                    resolved: false
                }
            ];
            updateAlertsDisplay();
            
            // æ¨¡æ“¬åˆå§‹è­¦å ±
            setTimeout(() => {
                addAlert({
                    type: 'info',
                    title: 'ç³»çµ±åˆå§‹åŒ–å®Œæˆ',
                    message: 'æ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨å·²æº–å‚™å°±ç·’',
                    resolved: true
                });
            }, 2000);
            
            // é¡¯ç¤ºæ­¡è¿æ¶ˆæ¯
            setTimeout(() => {
                showNotification('æ­¡è¿ä½¿ç”¨IoTæ™ºæ…§åŸå¸‚æ¨¡æ“¬å™¨ï¼é»æ“Šã€Œå¹³å°æ“ä½œæŒ‡å—ã€äº†è§£è©³ç´°ç©æ³•ã€‚', 'info');
            }, 1000);
            
            // æ¨¡æ“¬å®šæœŸç³»çµ±æ›´æ–°
            setInterval(() => {
                if (currentPage === 'city' || currentPage === 'data' || currentPage === 'optimization') {
                    updateStats();
                    updateChallenges();
                }
            }, 30000); // æ¯30ç§’æ›´æ–°ä¸€æ¬¡
        });
    </script>
</body>
</html>